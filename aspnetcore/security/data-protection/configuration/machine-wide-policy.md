---
title: Unterstützung der Computer weiten Datenschutzrichtlinie in ASP.net Core
author: rick-anderson
description: Erfahren Sie mehr über die Unterstützung für das Festlegen einer standardmäßigen Computer weiten Richtlinie für alle apps, die ASP.net Core Datenschutz nutzen.
ms.author: riande
ms.date: 10/14/2016
no-loc:
- ':::no-loc(appsettings.json):::'
- ':::no-loc(ASP.NET Core Identity):::'
- ':::no-loc(cookie):::'
- ':::no-loc(Cookie):::'
- ':::no-loc(Blazor):::'
- ':::no-loc(Blazor Server):::'
- ':::no-loc(Blazor WebAssembly):::'
- ':::no-loc(Identity):::'
- ":::no-loc(Let's Encrypt):::"
- ':::no-loc(Razor):::'
- ':::no-loc(SignalR):::'
uid: security/data-protection/configuration/machine-wide-policy
ms.openlocfilehash: f6f258e193bf964cb9b4cbd24da2740c5ed89a91
ms.sourcegitcommit: ca34c1ac578e7d3daa0febf1810ba5fc74f60bbf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/30/2020
ms.locfileid: "93052993"
---
# <a name="data-protection-machine-wide-policy-support-in-aspnet-core"></a><span data-ttu-id="9598e-103">Unterstützung der Computer weiten Datenschutzrichtlinie in ASP.net Core</span><span class="sxs-lookup"><span data-stu-id="9598e-103">Data Protection machine-wide policy support in ASP.NET Core</span></span>

<span data-ttu-id="9598e-104">Von [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="9598e-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="9598e-105">Bei Ausführung unter Windows bietet das Datenschutzsystem eingeschränkte Unterstützung für das Festlegen einer standardmäßigen Computer weiten Richtlinie für alle apps, die ASP.net Core Datenschutz nutzen.</span><span class="sxs-lookup"><span data-stu-id="9598e-105">When running on Windows, the Data Protection system has limited support for setting a default machine-wide policy for all apps that consume ASP.NET Core Data Protection.</span></span> <span data-ttu-id="9598e-106">Die allgemeine Idee ist, dass ein Administrator möglicherweise eine Standardeinstellung ändern möchte, z. b. die verwendeten Algorithmen oder die Schlüssel Lebensdauer, ohne dass jede APP auf dem Computer manuell aktualisiert werden muss.</span><span class="sxs-lookup"><span data-stu-id="9598e-106">The general idea is that an administrator might wish to change a default setting, such as the algorithms used or key lifetime, without the need to manually update every app on the machine.</span></span>

> [!WARNING]
> <span data-ttu-id="9598e-107">Der Systemadministrator kann die Standard Richtlinie festlegen, aber nicht erzwingen.</span><span class="sxs-lookup"><span data-stu-id="9598e-107">The system administrator can set default policy, but they can't enforce it.</span></span> <span data-ttu-id="9598e-108">Der App-Entwickler kann jeden beliebigen Wert mit einer ihrer eigenen Auswahl überschreiben.</span><span class="sxs-lookup"><span data-stu-id="9598e-108">The app developer can always override any value with one of their own choosing.</span></span> <span data-ttu-id="9598e-109">Die Standard Richtlinie wirkt sich nur auf apps aus, bei denen der Entwickler keinen expliziten Wert für eine Einstellung angegeben hat.</span><span class="sxs-lookup"><span data-stu-id="9598e-109">The default policy only affects apps where the developer hasn't specified an explicit value for a setting.</span></span>

## <a name="setting-default-policy"></a><span data-ttu-id="9598e-110">Festlegen der Standard Richtlinie</span><span class="sxs-lookup"><span data-stu-id="9598e-110">Setting default policy</span></span>

<span data-ttu-id="9598e-111">Um die Standard Richtlinie festzulegen, kann ein Administrator bekannte Werte in der Systemregistrierung unter folgendem Registrierungsschlüssel festlegen:</span><span class="sxs-lookup"><span data-stu-id="9598e-111">To set default policy, an administrator can set known values in the system registry under the following registry key:</span></span>

<span data-ttu-id="9598e-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span><span class="sxs-lookup"><span data-stu-id="9598e-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span></span>

<span data-ttu-id="9598e-113">Wenn Sie ein 64-Bit-Betriebssystem verwenden und das Verhalten von 32-Bit-apps beeinflussen möchten, denken Sie daran, die Wow6432Node-Entsprechung des obigen Schlüssels zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="9598e-113">If you're on a 64-bit operating system and want to affect the behavior of 32-bit apps, remember to configure the Wow6432Node equivalent of the above key.</span></span>

<span data-ttu-id="9598e-114">Die unterstützten Werte sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="9598e-114">The supported values are shown below.</span></span>

| <span data-ttu-id="9598e-115">Wert</span><span class="sxs-lookup"><span data-stu-id="9598e-115">Value</span></span>              | <span data-ttu-id="9598e-116">Typ</span><span class="sxs-lookup"><span data-stu-id="9598e-116">Type</span></span>   | <span data-ttu-id="9598e-117">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9598e-117">Description</span></span> |
| ------------------ | :----: | ----------- |
| <span data-ttu-id="9598e-118">EncryptionType</span><span class="sxs-lookup"><span data-stu-id="9598e-118">EncryptionType</span></span>     | <span data-ttu-id="9598e-119">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-119">string</span></span> | <span data-ttu-id="9598e-120">Gibt an, welche Algorithmen für den Datenschutz verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="9598e-120">Specifies which algorithms should be used for data protection.</span></span> <span data-ttu-id="9598e-121">Der Wert muss CNG-CBC, CNG-GCM oder Managed lauten und wird unten ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9598e-121">The value must be CNG-CBC, CNG-GCM, or Managed and is described in more detail below.</span></span> |
| <span data-ttu-id="9598e-122">Defaultkeylifetime</span><span class="sxs-lookup"><span data-stu-id="9598e-122">DefaultKeyLifetime</span></span> | <span data-ttu-id="9598e-123">DWORD</span><span class="sxs-lookup"><span data-stu-id="9598e-123">DWORD</span></span>  | <span data-ttu-id="9598e-124">Gibt die Lebensdauer für neu generierte Schlüssel an.</span><span class="sxs-lookup"><span data-stu-id="9598e-124">Specifies the lifetime for newly-generated keys.</span></span> <span data-ttu-id="9598e-125">Der Wert wird in Tagen angegeben und muss >= 7 sein.</span><span class="sxs-lookup"><span data-stu-id="9598e-125">The value is specified in days and must be >= 7.</span></span> |
| <span data-ttu-id="9598e-126">Keyescrowsinks</span><span class="sxs-lookup"><span data-stu-id="9598e-126">KeyEscrowSinks</span></span>     | <span data-ttu-id="9598e-127">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-127">string</span></span> | <span data-ttu-id="9598e-128">Gibt die Typen an, die für die Schlüssel Hinterlegung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9598e-128">Specifies the types that are used for key escrow.</span></span> <span data-ttu-id="9598e-129">Der Wert ist eine durch Semikolons getrennte Liste von Schlüssel Hinterlegungs senken, wobei jedes Element in der Liste der durch die Assembly qualifizierte Name eines Typs ist, der [ikeyescrowsink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink)implementiert.</span><span class="sxs-lookup"><span data-stu-id="9598e-129">The value is a semicolon-delimited list of key escrow sinks, where each element in the list is the assembly-qualified name of a type that implements [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink).</span></span> |

## <a name="encryption-types"></a><span data-ttu-id="9598e-130">Verschlüsselungstypen</span><span class="sxs-lookup"><span data-stu-id="9598e-130">Encryption types</span></span>

<span data-ttu-id="9598e-131">Wenn Verschlüsselungstyp CNG-CBC ist, wird das System für die Verwendung eines symmetrischen Blockchiffre im CBC-Modus für Vertraulichkeit und HMAC für die Authentizität mit den von Windows CNG bereitgestellten Diensten konfiguriert (Weitere Informationen finden Sie unter [Angeben von benutzerdefinierten Windows CNG-Algorithmen](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) ).</span><span class="sxs-lookup"><span data-stu-id="9598e-131">If EncryptionType is CNG-CBC, the system is configured to use a CBC-mode symmetric block cipher for confidentiality and HMAC for authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="9598e-132">Die folgenden zusätzlichen Werte werden unterstützt, von denen jeder einer Eigenschaft im cngcbcauthenticatedencryptionsettings-Typ entspricht.</span><span class="sxs-lookup"><span data-stu-id="9598e-132">The following additional values are supported, each of which corresponds to a property on the CngCbcAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="9598e-133">Wert</span><span class="sxs-lookup"><span data-stu-id="9598e-133">Value</span></span>                       | <span data-ttu-id="9598e-134">Typ</span><span class="sxs-lookup"><span data-stu-id="9598e-134">Type</span></span>   | <span data-ttu-id="9598e-135">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9598e-135">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="9598e-136">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="9598e-136">EncryptionAlgorithm</span></span>         | <span data-ttu-id="9598e-137">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-137">string</span></span> | <span data-ttu-id="9598e-138">Der Name eines symmetrischen Blockchiffre Algorithmus, der von CNG interpretiert wird.</span><span class="sxs-lookup"><span data-stu-id="9598e-138">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="9598e-139">Dieser Algorithmus wird im CBC-Modus geöffnet.</span><span class="sxs-lookup"><span data-stu-id="9598e-139">This algorithm is opened in CBC mode.</span></span> |
| <span data-ttu-id="9598e-140">Verschlüsselungs algorithmuprovider</span><span class="sxs-lookup"><span data-stu-id="9598e-140">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="9598e-141">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-141">string</span></span> | <span data-ttu-id="9598e-142">Der Name der CNG-Anbieter Implementierung, die den Algorithmus "Verschlüsselungalgorithmus" bilden kann.</span><span class="sxs-lookup"><span data-stu-id="9598e-142">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="9598e-143">Verschlüsselungsalgorithmkeysize</span><span class="sxs-lookup"><span data-stu-id="9598e-143">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="9598e-144">DWORD</span><span class="sxs-lookup"><span data-stu-id="9598e-144">DWORD</span></span>  | <span data-ttu-id="9598e-145">Die Länge des Schlüssels (in Bits), der für den symmetrischen Blockchiffre Algorithmus abgeleitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9598e-145">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |
| <span data-ttu-id="9598e-146">HashAlgorithm</span><span class="sxs-lookup"><span data-stu-id="9598e-146">HashAlgorithm</span></span>               | <span data-ttu-id="9598e-147">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-147">string</span></span> | <span data-ttu-id="9598e-148">Der Name eines Hash Algorithmus, der von CNG interpretiert wird.</span><span class="sxs-lookup"><span data-stu-id="9598e-148">The name of a hash algorithm understood by CNG.</span></span> <span data-ttu-id="9598e-149">Dieser Algorithmus wird im HMAC-Modus geöffnet.</span><span class="sxs-lookup"><span data-stu-id="9598e-149">This algorithm is opened in HMAC mode.</span></span> |
| <span data-ttu-id="9598e-150">Hashalgorithmprovider</span><span class="sxs-lookup"><span data-stu-id="9598e-150">HashAlgorithmProvider</span></span>       | <span data-ttu-id="9598e-151">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-151">string</span></span> | <span data-ttu-id="9598e-152">Der Name der CNG-Anbieter Implementierung, die den Algorithmus HashAlgorithm bilden kann.</span><span class="sxs-lookup"><span data-stu-id="9598e-152">The name of the CNG provider implementation that can produce the algorithm HashAlgorithm.</span></span> |

<span data-ttu-id="9598e-153">Wenn der Verschlüsselungstyp CNG-GCM ist, wird das System so konfiguriert, dass er eine Verschlüsselung mit dem symmetrischen Block "Galois/Counter Mode" für Vertraulichkeit und Authentizität mit Diensten von Windows CNG verwendet (Weitere Informationen finden Sie unter [Angeben von benutzerdefinierten Windows CNG-Algorithmen](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) ).</span><span class="sxs-lookup"><span data-stu-id="9598e-153">If EncryptionType is CNG-GCM, the system is configured to use a Galois/Counter Mode symmetric block cipher for confidentiality and authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="9598e-154">Die folgenden zusätzlichen Werte werden unterstützt, von denen jeder einer Eigenschaft des cnggcmauthenticatedencryptionsettings-Typs entspricht.</span><span class="sxs-lookup"><span data-stu-id="9598e-154">The following additional values are supported, each of which corresponds to a property on the CngGcmAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="9598e-155">Wert</span><span class="sxs-lookup"><span data-stu-id="9598e-155">Value</span></span>                       | <span data-ttu-id="9598e-156">Typ</span><span class="sxs-lookup"><span data-stu-id="9598e-156">Type</span></span>   | <span data-ttu-id="9598e-157">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9598e-157">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="9598e-158">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="9598e-158">EncryptionAlgorithm</span></span>         | <span data-ttu-id="9598e-159">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-159">string</span></span> | <span data-ttu-id="9598e-160">Der Name eines symmetrischen Blockchiffre Algorithmus, der von CNG interpretiert wird.</span><span class="sxs-lookup"><span data-stu-id="9598e-160">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="9598e-161">Dieser Algorithmus wird im Modus "Galois/Counter" geöffnet.</span><span class="sxs-lookup"><span data-stu-id="9598e-161">This algorithm is opened in Galois/Counter Mode.</span></span> |
| <span data-ttu-id="9598e-162">Verschlüsselungs algorithmuprovider</span><span class="sxs-lookup"><span data-stu-id="9598e-162">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="9598e-163">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-163">string</span></span> | <span data-ttu-id="9598e-164">Der Name der CNG-Anbieter Implementierung, die den Algorithmus "Verschlüsselungalgorithmus" bilden kann.</span><span class="sxs-lookup"><span data-stu-id="9598e-164">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="9598e-165">Verschlüsselungsalgorithmkeysize</span><span class="sxs-lookup"><span data-stu-id="9598e-165">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="9598e-166">DWORD</span><span class="sxs-lookup"><span data-stu-id="9598e-166">DWORD</span></span>  | <span data-ttu-id="9598e-167">Die Länge des Schlüssels (in Bits), der für den symmetrischen Blockchiffre Algorithmus abgeleitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9598e-167">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |

<span data-ttu-id="9598e-168">Wenn verschlüsselungstype verwaltet wird, ist das System so konfiguriert, dass ein verwaltetes SymmetricAlgorithm für Vertraulichkeit und KeyedHashAlgorithm für die Authentizität verwendet wird (Weitere Informationen finden Sie unter [Angeben von benutzerdefinierten verwalteten Algorithmen](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) ).</span><span class="sxs-lookup"><span data-stu-id="9598e-168">If EncryptionType is Managed, the system is configured to use a managed SymmetricAlgorithm for confidentiality and KeyedHashAlgorithm for authenticity (see [Specifying custom managed algorithms](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) for more details).</span></span> <span data-ttu-id="9598e-169">Die folgenden zusätzlichen Werte werden unterstützt, von denen jeder einer Eigenschaft im managedauthenticatedencryptionsettings-Typ entspricht.</span><span class="sxs-lookup"><span data-stu-id="9598e-169">The following additional values are supported, each of which corresponds to a property on the ManagedAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="9598e-170">Wert</span><span class="sxs-lookup"><span data-stu-id="9598e-170">Value</span></span>                      | <span data-ttu-id="9598e-171">Typ</span><span class="sxs-lookup"><span data-stu-id="9598e-171">Type</span></span>   | <span data-ttu-id="9598e-172">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9598e-172">Description</span></span> |
| -------------------------- | :----: | ----------- |
| <span data-ttu-id="9598e-173">Verschlüsselungsalgorithmtype</span><span class="sxs-lookup"><span data-stu-id="9598e-173">EncryptionAlgorithmType</span></span>    | <span data-ttu-id="9598e-174">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-174">string</span></span> | <span data-ttu-id="9598e-175">Der durch die Assembly qualifizierte Name eines Typs, der SymmetricAlgorithm implementiert.</span><span class="sxs-lookup"><span data-stu-id="9598e-175">The assembly-qualified name of a type that implements SymmetricAlgorithm.</span></span> |
| <span data-ttu-id="9598e-176">Verschlüsselungsalgorithmkeysize</span><span class="sxs-lookup"><span data-stu-id="9598e-176">EncryptionAlgorithmKeySize</span></span> | <span data-ttu-id="9598e-177">DWORD</span><span class="sxs-lookup"><span data-stu-id="9598e-177">DWORD</span></span>  | <span data-ttu-id="9598e-178">Die Länge des Schlüssels (in Bits), der für den symmetrischen Verschlüsselungsalgorithmus abgeleitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9598e-178">The length (in bits) of the key to derive for the symmetric encryption algorithm.</span></span> |
| <span data-ttu-id="9598e-179">Validationalgorithmtype</span><span class="sxs-lookup"><span data-stu-id="9598e-179">ValidationAlgorithmType</span></span>    | <span data-ttu-id="9598e-180">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="9598e-180">string</span></span> | <span data-ttu-id="9598e-181">Der durch die Assembly qualifizierte Name eines Typs, der KeyedHashAlgorithm implementiert.</span><span class="sxs-lookup"><span data-stu-id="9598e-181">The assembly-qualified name of a type that implements KeyedHashAlgorithm.</span></span> |

<span data-ttu-id="9598e-182">Wenn der Verschlüsselungstyp einen anderen Wert als NULL oder leer hat, löst das Datenschutzsystem beim Start eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="9598e-182">If EncryptionType has any other value other than null or empty, the Data Protection system throws an exception at startup.</span></span>

> [!WARNING]
> <span data-ttu-id="9598e-183">Beim Konfigurieren einer Standardrichtlinien Einstellung, die Typnamen einschließt ("verschlüsselungalgorithmtype", "validationalgorithmtype", "keyescrowsinks"), müssen die Typen für die app verfügbar sein.</span><span class="sxs-lookup"><span data-stu-id="9598e-183">When configuring a default policy setting that involves type names (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), the types must be available to the app.</span></span> <span data-ttu-id="9598e-184">Dies bedeutet, dass die Assemblys, die diese Typen enthalten, im globalen Assemblycache (Global Assembly Cache, GAC) vorhanden sein sollten.</span><span class="sxs-lookup"><span data-stu-id="9598e-184">This means that for apps running on Desktop CLR, the assemblies that contain these types should be present in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="9598e-185">Für ASP.net Core-apps, die unter .net Core ausgeführt werden, sollten die Pakete installiert werden, die diese Typen enthalten.</span><span class="sxs-lookup"><span data-stu-id="9598e-185">For ASP.NET Core apps running on .NET Core, the packages that contain these types should be installed.</span></span>
