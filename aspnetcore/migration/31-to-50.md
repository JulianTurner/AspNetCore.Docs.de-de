---
title: Migrieren von ASP.net Core 3,1 zu 5,0
author: scottaddie
description: Erfahren Sie, wie Sie ein ASP.net Core 3,1-Projekt zu ASP.net Core 5,0 migrieren.
ms.author: scaddie
ms.custom: mvc
ms.date: 12/02/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: migration/31-to-50
ms.openlocfilehash: 00949acff9908b4a75b6604396876b9c6c41cb3a
ms.sourcegitcommit: 37186f76e4a50d7fb7389026dd0e5e234b51ebb2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/04/2021
ms.locfileid: "99541354"
---
# <a name="migrate-from-aspnet-core-31-to-50"></a><span data-ttu-id="90a38-103">Migrieren von ASP.net Core 3,1 zu 5,0</span><span class="sxs-lookup"><span data-stu-id="90a38-103">Migrate from ASP.NET Core 3.1 to 5.0</span></span>

<span data-ttu-id="90a38-104">Von [Scott Addie](https://github.com/scottaddie)</span><span class="sxs-lookup"><span data-stu-id="90a38-104">By [Scott Addie](https://github.com/scottaddie)</span></span>

<span data-ttu-id="90a38-105">In diesem Artikel wird erläutert, wie ein vorhandenes ASP.net Core 3,1-Projekt auf ASP.net Core 5,0 aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="90a38-105">This article explains how to update an existing ASP.NET Core 3.1 project to ASP.NET Core 5.0.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="90a38-106">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="90a38-106">Prerequisites</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="90a38-107">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="90a38-107">Visual Studio</span></span>](#tab/visual-studio)

[!INCLUDE[](~/includes/net-core-prereqs-vs-5.0.md)]

# <a name="visual-studio-code"></a>[<span data-ttu-id="90a38-108">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="90a38-108">Visual Studio Code</span></span>](#tab/visual-studio-code)

[!INCLUDE[](~/includes/net-core-prereqs-vsc-5.0.md)]

# <a name="visual-studio-for-mac"></a>[<span data-ttu-id="90a38-109">Visual Studio für Mac</span><span class="sxs-lookup"><span data-stu-id="90a38-109">Visual Studio for Mac</span></span>](#tab/visual-studio-mac)

[!INCLUDE[](~/includes/net-core-prereqs-mac-5.0.md)]

---

## <a name="update-net-core-sdk-version-in-globaljson"></a><span data-ttu-id="90a38-110">Aktualisieren der .NET Core SDK-Version in „global.json“</span><span class="sxs-lookup"><span data-stu-id="90a38-110">Update .NET Core SDK version in global.json</span></span>

<span data-ttu-id="90a38-111">Wenn Sie sich für eine bestimmte .net Core SDK Version auf eine [global.jsin](/dotnet/core/tools/global-json) der Datei verlassen, aktualisieren Sie die `version` -Eigenschaft auf die installierte Version von .net 5,0 SDK.</span><span class="sxs-lookup"><span data-stu-id="90a38-111">If you rely upon a [global.json](/dotnet/core/tools/global-json) file to target a specific .NET Core SDK version, update the `version` property to the .NET 5.0 SDK version that's installed.</span></span> <span data-ttu-id="90a38-112">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="90a38-112">For example:</span></span>

```diff
{
  "sdk": {
-    "version": "3.1.200"
+    "version": "5.0.100"
  }
}
```

## <a name="update-the-target-framework"></a><span data-ttu-id="90a38-113">Aktualisieren des Ziel Frameworks</span><span class="sxs-lookup"><span data-stu-id="90a38-113">Update the target framework</span></span>

<span data-ttu-id="90a38-114">Wenn Sie ein Blazor WebAssembly Projekt aktualisieren, fahren Sie mit dem Abschnitt [ Blazor WebAssembly Projekte aktualisieren](#update-blazor-webassembly-projects) fort.</span><span class="sxs-lookup"><span data-stu-id="90a38-114">If updating a Blazor WebAssembly project, skip to the [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) section.</span></span> <span data-ttu-id="90a38-115">Für alle anderen ASP.net Core Projekttyp aktualisieren Sie den [zielframeworkmoniker (TFM)](/dotnet/standard/frameworks) der Projektdatei auf Folgendes `net5.0` :</span><span class="sxs-lookup"><span data-stu-id="90a38-115">For any other ASP.NET Core project type, update the project file's [Target Framework Moniker (TFM)](/dotnet/standard/frameworks) to `net5.0`:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
  </PropertyGroup>

</Project>
```

## <a name="changes-to-blazor-app-routing-logic-in-501-and-further-5x-releases-up-to-60"></a><span data-ttu-id="90a38-116">Änderungen an Blazor der APP-Routing Logik in 5.0.1 und weiteren 5. x-Versionen bis zu 6,0</span><span class="sxs-lookup"><span data-stu-id="90a38-116">Changes to Blazor app routing logic in 5.0.1 and further 5.x releases up to 6.0</span></span>

<span data-ttu-id="90a38-117">Die Berechnung der Routen Rangfolge wurde in der Patch-Version ASP.net Core 5.0.1 geändert.</span><span class="sxs-lookup"><span data-stu-id="90a38-117">The computation of route precedence changed in the ASP.NET Core 5.0.1 patch release.</span></span> <span data-ttu-id="90a38-118">Dies kann sich auf Sie auswirken, wenn Sie Catch-All-Routen oder-Routen mit optionalen Parametern definiert haben.</span><span class="sxs-lookup"><span data-stu-id="90a38-118">This might affect you if you've defined catch-all routes or routes with optional parameters.</span></span>

### <a name="old-behavior"></a><span data-ttu-id="90a38-119">Altes Verhalten</span><span class="sxs-lookup"><span data-stu-id="90a38-119">Old behavior</span></span>

<span data-ttu-id="90a38-120">Mit dem früheren Verhalten in ASP.net Core 5.0.0 oder früher werden Routen mit niedrigerer Rangfolge (z `{*slug}` . b.) vor Routen mit höherer Rangfolge abgeglichen, z `/customer/{id}` . b..</span><span class="sxs-lookup"><span data-stu-id="90a38-120">With the prior behavior in ASP.NET Core 5.0.0 or earlier, routes with lower precedence, such as `{*slug}`, are matched before routes with higher precedence, such as `/customer/{id}`.</span></span>

### <a name="new-behavior"></a><span data-ttu-id="90a38-121">Neues Verhalten</span><span class="sxs-lookup"><span data-stu-id="90a38-121">New behavior</span></span>

<span data-ttu-id="90a38-122">Das neue Verhalten in ASP.net Core 5.0.1 oder höher stimmt genauer mit dem Routing Verhalten überein, das in ASP.net Core-apps definiert ist, wobei das Framework zuerst die Routen Rangfolge für jedes Segment berechnet und festlegt und nur die Länge der Route zum Unterbrechen von Verknüpfungen als sekundäre Kriterien verwendet.</span><span class="sxs-lookup"><span data-stu-id="90a38-122">The new behavior in ASP.NET Core 5.0.1 or later more closely matches the routing behavior defined in ASP.NET Core apps, where the framework computes and establishes the route precedence for each segment first and only uses the length of the route to break ties as a secondary criteria.</span></span>

### <a name="reason-for-change"></a><span data-ttu-id="90a38-123">Grund für die Änderung</span><span class="sxs-lookup"><span data-stu-id="90a38-123">Reason for change</span></span>

<span data-ttu-id="90a38-124">Das ursprüngliche Verhalten wird in der Implementierung als Fehler betrachtet, da es sich um das Ziel des Routing Systems handelt, das sich auf Blazor die gleiche Weise verhält wie das ASP.net Core Routing System für die Teilmenge der Features, die durch das Routing unterstützt werden Blazor .</span><span class="sxs-lookup"><span data-stu-id="90a38-124">The original behavior is considered a bug in the implementation because our goal is for the Blazor routing system to behave in the same way as the ASP.NET Core routing system for the subset of features supported by Blazor routing.</span></span>

### <a name="recommended-action"></a><span data-ttu-id="90a38-125">Empfohlene Maßnahme</span><span class="sxs-lookup"><span data-stu-id="90a38-125">Recommended action</span></span>

<span data-ttu-id="90a38-126">Fügen Sie das- `PreferExactMatches` Attribut der `Router` Komponente in `App.razor` der Datei hinzu, um das richtige Verhalten zu abonnieren:</span><span class="sxs-lookup"><span data-stu-id="90a38-126">Add the `PreferExactMatches` attribute to the `Router` component in the `App.razor` file to opt into the correct behavior:</span></span>

```razor
<Router AppAssembly="@typeof(Program).Assembly" PreferExactMatches="@true">
```

<span data-ttu-id="90a38-127">Wenn `PreferExactMatches` auf `@true` festgelegt ist, bevorzugt die Routenzuordnung exakte Übereinstimmungen gegenüber Platzhaltern.</span><span class="sxs-lookup"><span data-stu-id="90a38-127">When `PreferExactMatches` is set to `@true`, route matching prefers exact matches over wildcards.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="90a38-128">Alle apps sollten explizit auf festgelegt werden `PreferExactMatches` `@true` .</span><span class="sxs-lookup"><span data-stu-id="90a38-128">All apps should explicitly set `PreferExactMatches` to `@true`.</span></span>
>
> <span data-ttu-id="90a38-129">Die Möglichkeit, die Einstellung auf festzulegen `PreferExactMatches` `@false` oder zu verlassen, *wird nur aus Gründen der Abwärtskompatibilität bereitgestellt*.</span><span class="sxs-lookup"><span data-stu-id="90a38-129">The ability to set `PreferExactMatches` to `@false` or leave it unset *is only provided for backward compatibility*.</span></span>
>
> <span data-ttu-id="90a38-130">Wenn .net 6 veröffentlicht wird, bevorzugt der Router immer exakte Übereinstimmungen, und die `PreferExactMatches` Option ist nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="90a38-130">When .NET 6 is released, the router will always prefer exact matches, and the `PreferExactMatches` option won't be available.</span></span>

## <a name="update-blazor-webassembly-and-blazor-server-projects"></a><span data-ttu-id="90a38-131">Aktualisieren Blazor WebAssembly und Blazor Server Projekte</span><span class="sxs-lookup"><span data-stu-id="90a38-131">Update Blazor WebAssembly and Blazor Server projects</span></span>

<span data-ttu-id="90a38-132">*Die Anleitungen in diesem Abschnitt gelten für beide Blazor Hostingmodelle. In den Abschnitten dieses Abschnitts finden Sie zusätzliche Anleitungen für das Hosting von Modellen und App-Typen. Wenden Sie die Anleitungen aus allen relevanten Abschnitten auf Ihre APP an.*</span><span class="sxs-lookup"><span data-stu-id="90a38-132">*The guidance in this section applies to both Blazor hosting models. Sections following this section provide additional guidance specific to hosting models and app types. Apply the guidance from all relevant sections to your app.*</span></span>

1. <span data-ttu-id="90a38-133">`wwwroot/index.html`Fügen Sie in einer- Blazor WebAssembly app oder einer- `Pages/_Host.cshtml` Blazor Server App dem- `<link>` Element für Stile ein-Element hinzu `<head>` .</span><span class="sxs-lookup"><span data-stu-id="90a38-133">In `wwwroot/index.html` of a Blazor WebAssembly app or the `Pages/_Host.cshtml` of a Blazor Server app, add a `<link>` element to the `<head>` element for styles.</span></span> <span data-ttu-id="90a38-134">In den folgenden `<link>` Element `href` Attributwerten ist der Platzhalter `{ASSEMBLY NAME}` der AssemblyName der app.</span><span class="sxs-lookup"><span data-stu-id="90a38-134">In the following `<link>` element `href` attribute values, the placeholder `{ASSEMBLY NAME}` is the app's assembly name.</span></span>

    ```diff
    +<link href="{ASSEMBLY NAME}.styles.css" rel="stylesheet" />
    ```

    <span data-ttu-id="90a38-135">Eigenständiges Blazor WebAssembly oder Blazor Server Beispiel:</span><span class="sxs-lookup"><span data-stu-id="90a38-135">Standalone Blazor WebAssembly or Blazor Server example:</span></span>

    ```diff
    +<link href="BlazorSample.styles.css" rel="stylesheet" />
    ```

    <span data-ttu-id="90a38-136">*`Client`* Projekt eines gehosteten Blazor WebAssembly Lösungs Beispiels:</span><span class="sxs-lookup"><span data-stu-id="90a38-136">*`Client`* project of a hosted Blazor WebAssembly solution example:</span></span>

    ```diff
    +<link href="BlazorSample.Client.styles.css" rel="stylesheet" />
    ```

1. <span data-ttu-id="90a38-137">Fügen Sie einen neuen Namespace in die Datei der APP `_Imports.razor` für die [komponentenvirtualisierung](xref:blazor/components/virtualization)ein <xref:Microsoft.AspNetCore.Components.Web.Virtualization?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="90a38-137">Include a new namespace in the app's `_Imports.razor` file for [component virtualization](xref:blazor/components/virtualization), <xref:Microsoft.AspNetCore.Components.Web.Virtualization?displayProperty=fullName>.</span></span> <span data-ttu-id="90a38-138">In den folgenden `_Imports.razor` Dateien werden die Standardnamespaces in apps angezeigt, die aus den Blazor Projektvorlagen generiert wurden.</span><span class="sxs-lookup"><span data-stu-id="90a38-138">The following `_Imports.razor` files show the default namespaces in apps generated from the Blazor project templates.</span></span> <span data-ttu-id="90a38-139">Der Platzhalter `{ASSEMBLY NAME}` ist der AssemblyName der app.</span><span class="sxs-lookup"><span data-stu-id="90a38-139">The placeholder `{ASSEMBLY NAME}` is the app's assembly name.</span></span>

   <span data-ttu-id="90a38-140">Blazor WebAssembly (`_Imports.razor`):</span><span class="sxs-lookup"><span data-stu-id="90a38-140">Blazor WebAssembly (`_Imports.razor`):</span></span>
   
   ```razor
   @using System.Net.Http
   @using System.Net.Http.Json
   @using Microsoft.AspNetCore.Components.Forms
   @using Microsoft.AspNetCore.Components.Routing
   @using Microsoft.AspNetCore.Components.Web
   @using Microsoft.AspNetCore.Components.Web.Virtualization
   @using Microsoft.AspNetCore.Components.WebAssembly.Http
   @using Microsoft.JSInterop
   @using {ASSEMBLY NAME}
   @using {ASSEMBLY NAME}.Shared
   ```

   <span data-ttu-id="90a38-141">Blazor Server (`_Imports.razor`):</span><span class="sxs-lookup"><span data-stu-id="90a38-141">Blazor Server (`_Imports.razor`):</span></span>
   
   ```razor
   @using System.Net.Http
   @using Microsoft.AspNetCore.Authorization
   @using Microsoft.AspNetCore.Components.Authorization
   @using Microsoft.AspNetCore.Components.Forms
   @using Microsoft.AspNetCore.Components.Routing
   @using Microsoft.AspNetCore.Components.Web
   @using Microsoft.AspNetCore.Components.Web.Virtualization
   @using Microsoft.JSInterop
   @using {ASSEMBLY NAME}
   @using {ASSEMBLY NAME}.Shared
   ```
   
1. <span data-ttu-id="90a38-142">`MainLayout`Umgeben Sie in der `Shared/MainLayout.razor` -Komponente () das HTML-Markup der Komponente mit einem- `<div>` Element, für das ein- `class` Attribut auf festgelegt ist `page` :</span><span class="sxs-lookup"><span data-stu-id="90a38-142">In the `MainLayout` component (`Shared/MainLayout.razor`), surround the component's HTML markup with a `<div>` element that has a `class` attribute set to `page`:</span></span>

    ```razor
    <div class="page">
    
        ...
        
    </div>
    ```
    
1. <span data-ttu-id="90a38-143">Fügen Sie dem Ordner die folgenden Dateien hinzu `Shared` :</span><span class="sxs-lookup"><span data-stu-id="90a38-143">Add the following files to the `Shared` folder:</span></span>

    <span data-ttu-id="90a38-144">`MainLayout.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="90a38-144">`MainLayout.razor.css`:</span></span>
    
    ```css
    .page {
        position: relative;
        display: flex;
        flex-direction: column;
    }

    .main {
        flex: 1;
    }

    .sidebar {
        background-image: linear-gradient(180deg, rgb(5, 39, 103) 0%, #3a0647 70%);
    }

    .top-row {
        background-color: #f7f7f7;
        border-bottom: 1px solid #d6d5d5;
        justify-content: flex-end;
        height: 3.5rem;
        display: flex;
        align-items: center;
    }

        .top-row ::deep a, .top-row .btn-link {
            white-space: nowrap;
            margin-left: 1.5rem;
        }

        .top-row a:first-child {
            overflow: hidden;
            text-overflow: ellipsis;
        }

    @media (max-width: 767.98px) {
        .top-row:not(.auth) {
            display: none;
        }

        .top-row.auth {
            justify-content: space-between;
        }

        .top-row a, .top-row .btn-link {
            margin-left: 0;
        }
    }

    @media (min-width: 768px) {
        .page {
            flex-direction: row;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            position: sticky;
            top: 0;
        }

        .top-row {
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .main > div {
            padding-left: 2rem !important;
            padding-right: 1.5rem !important;
        }
    }
    ```
    
    <span data-ttu-id="90a38-145">`NavMenu.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="90a38-145">`NavMenu.razor.css`:</span></span>
    
    ```css
    .navbar-toggler {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .top-row {
        height: 3.5rem;
        background-color: rgba(0,0,0,0.4);
    }

    .navbar-brand {
        font-size: 1.1rem;
    }

    .oi {
        width: 2rem;
        font-size: 1.1rem;
        vertical-align: text-top;
        top: -2px;
    }

    .nav-item {
        font-size: 0.9rem;
        padding-bottom: 0.5rem;
    }

        .nav-item:first-of-type {
            padding-top: 1rem;
        }

        .nav-item:last-of-type {
            padding-bottom: 1rem;
        }

        .nav-item ::deep a {
            color: #d7d7d7;
            border-radius: 4px;
            height: 3rem;
            display: flex;
            align-items: center;
            line-height: 3rem;
        }

    .nav-item ::deep a.active {
        background-color: rgba(255,255,255,0.25);
        color: white;
    }

    .nav-item ::deep a:hover {
        background-color: rgba(255,255,255,0.1);
        color: white;
    }

    @media (min-width: 768px) {
        .navbar-toggler {
            display: none;
        }

        .collapse {
            /* Never collapse the sidebar for wide screens */
            display: block;
        }
    }
    ```

1. <span data-ttu-id="90a38-146">Die neueste Basis `wwwroot/css/app.css` Datei einer APP Blazor WebAssembly oder einer `wwwroot/css/site.css` Datei einer Blazor Server app enthält die folgenden Stile.</span><span class="sxs-lookup"><span data-stu-id="90a38-146">The latest base `wwwroot/css/app.css` file of a Blazor WebAssembly app or `wwwroot/css/site.css` file of a Blazor Server app includes the following styles.</span></span> <span data-ttu-id="90a38-147">Entfernen Sie zusätzliche Stile, und übernehmen Sie die folgenden Stile und alle, die Sie der app hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="90a38-147">Remove extra styles leaving the following styles and any that you've added to the app.</span></span>

    <span data-ttu-id="90a38-148">Das folgende Stylesheet umfasst nur Basis Stile und enthält **keine** benutzerdefinierten Stile, die vom Entwickler hinzugefügt wurden:</span><span class="sxs-lookup"><span data-stu-id="90a38-148">The following stylesheet only includes base styles and does **not** include custom styles added by the developer:</span></span>
   
    ```css
    @import url('open-iconic/font/css/open-iconic-bootstrap.min.css');

    html, body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

    a, .btn-link {
        color: #0366d6;
    }

    .btn-primary {
        color: #fff;
        background-color: #1b6ec2;
        border-color: #1861ac;
    }

    .content {
        padding-top: 1.1rem;
    }

    .valid.modified:not([type=checkbox]) {
        outline: 1px solid #26b050;
    }

    .invalid {
        outline: 1px solid red;
    }

    .validation-message {
        color: red;
    }

    #blazor-error-ui {
        background: lightyellow;
        bottom: 0;
        box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.2);
        display: none;
        left: 0;
        padding: 0.6rem 1.25rem 0.7rem 1.25rem;
        position: fixed;
        width: 100%;
        z-index: 1000;
    }

    #blazor-error-ui .dismiss {
        cursor: pointer;
        position: absolute;
        right: 0.75rem;
        top: 0.5rem;
    }
    ```

## <a name="update-blazor-webassembly-projects"></a><span data-ttu-id="90a38-149">Aktualisieren von Blazor WebAssembly Projekten</span><span class="sxs-lookup"><span data-stu-id="90a38-149">Update Blazor WebAssembly projects</span></span>

<span data-ttu-id="90a38-150">Befolgen Sie die Anweisungen im vorherigen Abschnitt zu [Updates Blazor WebAssembly und Blazor Server Projekten](#update-blazor-webassembly-and-blazor-server-projects) .</span><span class="sxs-lookup"><span data-stu-id="90a38-150">Follow the guidance in the preceding [Update Blazor WebAssembly and Blazor Server projects](#update-blazor-webassembly-and-blazor-server-projects) section.</span></span>

<span data-ttu-id="90a38-151">Blazor WebAssemblyWenden Sie für ein Projekt, einschließlich des *`Client`* Projekts einer gehosteten Blazor Lösung, die folgenden Änderungen auf die Projektdatei an:</span><span class="sxs-lookup"><span data-stu-id="90a38-151">For a Blazor WebAssembly project, including the *`Client`* project of a hosted Blazor solution, apply the following changes to the project file:</span></span>

1. <span data-ttu-id="90a38-152">Aktualisieren Sie das SDK von `Microsoft.NET.Sdk.Web` auf `Microsoft.NET.Sdk.BlazorWebAssembly` :</span><span class="sxs-lookup"><span data-stu-id="90a38-152">Update the SDK from `Microsoft.NET.Sdk.Web` to `Microsoft.NET.Sdk.BlazorWebAssembly`:</span></span>

    ```diff
    - <Project Sdk="Microsoft.NET.Sdk.Web">
    + <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    ```
    
    > [!NOTE]
    > <span data-ttu-id="90a38-153">Dieses Update gilt nur für eigenständige Blazor WebAssembly Projekte und die *`Client`* Projekte gehosteter Blazor Lösungen.</span><span class="sxs-lookup"><span data-stu-id="90a38-153">This update only applies to standalone Blazor WebAssembly projects and the *`Client`* projects of hosted Blazor solutions.</span></span>

1. <span data-ttu-id="90a38-154">Aktualisieren Sie die folgenden Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="90a38-154">Update the following properties:</span></span>

    ```diff
    <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    
      <PropertyGroup>
    -     <TargetFramework>netstandard2.1</TargetFramework>
    -     <RazorLangVersion>3.0</RazorLangVersion>
    +     <TargetFramework>net5.0</TargetFramework>
      </PropertyGroup>
    ```

1. <span data-ttu-id="90a38-155">Entfernen Sie den Paket Verweis auf [Microsoft. aspnetcore. Components. Webassembly. Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build):</span><span class="sxs-lookup"><span data-stu-id="90a38-155">Remove the package reference to [Microsoft.AspNetCore.Components.WebAssembly.Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build):</span></span>

    ```diff
    <ItemGroup>
    -    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Build" Version="3.2.1" PrivateAssets="all" />
    ```

1. <span data-ttu-id="90a38-156">Aktualisieren Sie andere Pakete auf die neuesten Versionen.</span><span class="sxs-lookup"><span data-stu-id="90a38-156">Update other packages to their latest versions.</span></span> <span data-ttu-id="90a38-157">Die neuesten Versionen finden Sie unter [NuGet.org](https://www.nuget.org).</span><span class="sxs-lookup"><span data-stu-id="90a38-157">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

1. <span data-ttu-id="90a38-158">`wwwroot/index.html`Ändern Sie in das-Element, das die-Komponente lädt, in ein-Element, das `App` `<div>` `id` auf festgelegt ist `app` :</span><span class="sxs-lookup"><span data-stu-id="90a38-158">In `wwwroot/index.html`, change the element that loads the `App` component to a `<div>` element with an `id` set to `app`:</span></span>
    
    ```diff
    -<app>Loading...</app>
    +<div id="app">Loading...</div>
    ```

1. <span data-ttu-id="90a38-159">`Program.Main` `Program.cs` Ändern Sie in () den Verweis auf das `<app>` Element in einen CSS-Selektor, indem Sie einen Hashwert hinzufügen `#` :</span><span class="sxs-lookup"><span data-stu-id="90a38-159">In `Program.Main` (`Program.cs`), change the reference to the `<app>` element to a CSS selector by adding a hash `#` to it:</span></span>

    ```diff
    -builder.RootComponents.Add<App>("app");
    +builder.RootComponents.Add<App>("#app");
    ```

1. <span data-ttu-id="90a38-160">`Program.Main` `Program.cs` Ändern Sie in () eine standardmäßige vorübergehende `HttpClient` Registrierung in den Bereich, falls vorhanden:</span><span class="sxs-lookup"><span data-stu-id="90a38-160">In `Program.Main` (`Program.cs`), change a default transient `HttpClient` registration to scoped, if present:</span></span>

   ```diff
   -builder.Services.AddTransient(sp => new HttpClient 
   -    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
   +builder.Services.AddScoped(sp => new HttpClient 
   +    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
   ```

1. <span data-ttu-id="90a38-161">In `Program.Main` ( `Program.cs` ) der **`Client`** App gehosteter Blazor Lösungen:</span><span class="sxs-lookup"><span data-stu-id="90a38-161">In `Program.Main` (`Program.cs`) of the **`Client`** app of hosted Blazor solutions:</span></span>
    
   * <span data-ttu-id="90a38-162">Ersetzen Sie optional die `builder.HostEnvironment.BaseAddress` Basisadressen von Zeichen folgen Clients.</span><span class="sxs-lookup"><span data-stu-id="90a38-162">Optionally, substitute `builder.HostEnvironment.BaseAddress` for string client base addresses.</span></span>
   * <span data-ttu-id="90a38-163">Ändern Sie alle benannten vorübergehenden clientfactory-Registrierungen in den Gültigkeitsbereich.</span><span class="sxs-lookup"><span data-stu-id="90a38-163">Change any named transient client factory registrations to scoped.</span></span>

   ```diff
   -builder.Services.AddHttpClient("{APP NAMESPACE}.ServerAPI", 
   -    client => client.BaseAddress = new Uri("https://localhost:5001"))
   -    .AddHttpMessageHandler<BaseAddressAuthorizationMessageHandler>();
   -builder.Services.AddTransient(sp => sp.GetRequiredService<IHttpClientFactory>()
   -    .CreateClient("{APP NAMESPACE}.ServerAPI"));
   +builder.Services.AddHttpClient("{APP NAMESPACE}.ServerAPI", 
   +    client => client.BaseAddress = new Uri(builder.HostEnvironment.BaseAddress))
   +    .AddHttpMessageHandler<BaseAddressAuthorizationMessageHandler>();
   +builder.Services.AddScoped(sp => sp.GetRequiredService<IHttpClientFactory>()
   +    .CreateClient("{APP NAMESPACE}.ServerAPI"));
    ```
    
   <span data-ttu-id="90a38-164">Im vorangehenden Code ist der `{APP NAMESPACE}` Platzhalter der APP-Namespace.</span><span class="sxs-lookup"><span data-stu-id="90a38-164">In the preceding code, the `{APP NAMESPACE}` placeholder is the app's namespace.</span></span>

### <a name="standalone-blazor-webassembly-app-with-microsoft-accounts"></a><span data-ttu-id="90a38-165">Eigenständige Blazor WebAssembly App mit Microsoft-Konten</span><span class="sxs-lookup"><span data-stu-id="90a38-165">Standalone Blazor WebAssembly app with Microsoft Accounts</span></span>

<span data-ttu-id="90a38-166">Befolgen Sie die Anweisungen in den vorherigen Abschnitten [Update Blazor WebAssembly und Blazor Server Projekte](#update-blazor-webassembly-and-blazor-server-projects) und [Update Blazor WebAssembly Projekte](#update-blazor-webassembly-projects) .</span><span class="sxs-lookup"><span data-stu-id="90a38-166">Follow the guidance in the preceding [Update Blazor WebAssembly and Blazor Server projects](#update-blazor-webassembly-and-blazor-server-projects) and [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) sections.</span></span>

<span data-ttu-id="90a38-167">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) für Microsoft-Konten zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="90a38-167">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) for Microsoft Accounts:</span></span>

* <span data-ttu-id="90a38-168">Die APP erfordert die `openid` `offline_access` Bereiche und:</span><span class="sxs-lookup"><span data-stu-id="90a38-168">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="90a38-169">Auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** :</span><span class="sxs-lookup"><span data-stu-id="90a38-169">In the Azure portal app registration **Authentication** blade:</span></span>

  1. <span data-ttu-id="90a38-170">Entfernen Sie die **Webplattform** -Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="90a38-170">Remove the **Web** platform configuration.</span></span>
  1. <span data-ttu-id="90a38-171">Fügen Sie eine **Einzelseiten-Anwendungs** Platt Form Konfiguration mit dem Umleitungs-URI der APP hinzu.</span><span class="sxs-lookup"><span data-stu-id="90a38-171">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
  1. <span data-ttu-id="90a38-172">Deaktivieren Sie die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="90a38-172">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="90a38-173">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span><span class="sxs-lookup"><span data-stu-id="90a38-173">For more information, see <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span></span>

### <a name="standalone-blazor-webassembly-app-with-azure-active-directory-aad"></a><span data-ttu-id="90a38-174">Eigenständige Blazor WebAssembly App mit Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="90a38-174">Standalone Blazor WebAssembly app with Azure Active Directory (AAD)</span></span>

<span data-ttu-id="90a38-175">Befolgen Sie die Anweisungen in den vorherigen Abschnitten [Update Blazor WebAssembly und Blazor Server Projekte](#update-blazor-webassembly-and-blazor-server-projects) und [Update Blazor WebAssembly Projekte](#update-blazor-webassembly-projects) .</span><span class="sxs-lookup"><span data-stu-id="90a38-175">Follow the guidance in the preceding [Update Blazor WebAssembly and Blazor Server projects](#update-blazor-webassembly-and-blazor-server-projects) and [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) sections.</span></span>

<span data-ttu-id="90a38-176">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="90a38-176">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD):</span></span>

* <span data-ttu-id="90a38-177">Die APP erfordert den folgenden `https://graph.microsoft.com/User.Read` Bereich:</span><span class="sxs-lookup"><span data-stu-id="90a38-177">The app requires the `https://graph.microsoft.com/User.Read` scope:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes
      .Add("https://graph.microsoft.com/User.Read");
  ```
  
* <span data-ttu-id="90a38-178">Auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** :</span><span class="sxs-lookup"><span data-stu-id="90a38-178">In the Azure portal app registration **Authentication** blade:</span></span>

  1. <span data-ttu-id="90a38-179">Entfernen Sie die **Webplattform** -Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="90a38-179">Remove the **Web** platform configuration.</span></span>
  1. <span data-ttu-id="90a38-180">Fügen Sie eine **Einzelseiten-Anwendungs** Platt Form Konfiguration mit dem Umleitungs-URI der APP hinzu.</span><span class="sxs-lookup"><span data-stu-id="90a38-180">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
  1. <span data-ttu-id="90a38-181">Deaktivieren Sie die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="90a38-181">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>
  
<span data-ttu-id="90a38-182">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span><span class="sxs-lookup"><span data-stu-id="90a38-182">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span></span>

### <a name="standalone-blazor-webassembly-app-with-azure-active-directory-aad-b2c"></a><span data-ttu-id="90a38-183">Eigenständige Blazor WebAssembly App mit Azure Active Directory (AAD) B2C</span><span class="sxs-lookup"><span data-stu-id="90a38-183">Standalone Blazor WebAssembly app with Azure Active Directory (AAD) B2C</span></span>

<span data-ttu-id="90a38-184">Befolgen Sie die Anweisungen in den vorherigen Abschnitten [Update Blazor WebAssembly und Blazor Server Projekte](#update-blazor-webassembly-and-blazor-server-projects) und [Update Blazor WebAssembly Projekte](#update-blazor-webassembly-projects) .</span><span class="sxs-lookup"><span data-stu-id="90a38-184">Follow the guidance in the preceding [Update Blazor WebAssembly and Blazor Server projects](#update-blazor-webassembly-and-blazor-server-projects) and [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) sections.</span></span>

<span data-ttu-id="90a38-185">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) B2C zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="90a38-185">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) B2C:</span></span>

* <span data-ttu-id="90a38-186">Die APP erfordert die `openid` `offline_access` Bereiche und:</span><span class="sxs-lookup"><span data-stu-id="90a38-186">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="90a38-187">Auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** :</span><span class="sxs-lookup"><span data-stu-id="90a38-187">In the Azure portal app registration **Authentication** blade:</span></span>

  1. <span data-ttu-id="90a38-188">Entfernen Sie die **Webplattform** -Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="90a38-188">Remove the **Web** platform configuration.</span></span>
  1. <span data-ttu-id="90a38-189">Fügen Sie eine **Einzelseiten-Anwendungs** Platt Form Konfiguration mit dem Umleitungs-URI der APP hinzu.</span><span class="sxs-lookup"><span data-stu-id="90a38-189">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
  1. <span data-ttu-id="90a38-190">Deaktivieren Sie die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="90a38-190">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="90a38-191">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span><span class="sxs-lookup"><span data-stu-id="90a38-191">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span></span>

### <a name="hosted-blazor-webassembly-app-with-azure-active-directory-aad-or-aad-b2c"></a><span data-ttu-id="90a38-192">Gehostete Blazor WebAssembly App mit Azure Active Directory (AAD) oder Aad B2C</span><span class="sxs-lookup"><span data-stu-id="90a38-192">Hosted Blazor WebAssembly app with Azure Active Directory (AAD) or AAD B2C</span></span>

<span data-ttu-id="90a38-193">Befolgen Sie die Anweisungen in den vorherigen Abschnitten [Update Blazor WebAssembly und Blazor Server Projekte](#update-blazor-webassembly-and-blazor-server-projects) und [Update Blazor WebAssembly Projekte](#update-blazor-webassembly-projects) .</span><span class="sxs-lookup"><span data-stu-id="90a38-193">Follow the guidance in the preceding [Update Blazor WebAssembly and Blazor Server projects](#update-blazor-webassembly-and-blazor-server-projects) and [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) sections.</span></span>

<span data-ttu-id="90a38-194">*`Client`* Bei der APP-Registrierung einer gehosteten Blazor Lösung, die Aad oder Aad B2C für die Benutzerauthentifizierung verwendet, sollte eine **Single-Page-Anwendung** für die Azure-Apps-Plattform konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="90a38-194">The *`Client`* app registration of a hosted Blazor solution that uses AAD or AAD B2C for user authentication should use a **Single-page application** Azure Apps platform configuration.</span></span>

<span data-ttu-id="90a38-195">Auf dem *`Client`* Blatt Azure-Portal App-Registrierungs **Authentifizierung** :</span><span class="sxs-lookup"><span data-stu-id="90a38-195">In the Azure portal *`Client`* app registration **Authentication** blade:</span></span>

  1. <span data-ttu-id="90a38-196">Entfernen Sie die **Webplattform** -Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="90a38-196">Remove the **Web** platform configuration.</span></span>
  1. <span data-ttu-id="90a38-197">Fügen Sie eine **Einzelseiten-Anwendungs** Platt Form Konfiguration mit dem Umleitungs-URI der APP hinzu.</span><span class="sxs-lookup"><span data-stu-id="90a38-197">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
  1. <span data-ttu-id="90a38-198">Deaktivieren Sie die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="90a38-198">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="90a38-199">Weitere Informationen finden Sie in folgenden Quellen:</span><span class="sxs-lookup"><span data-stu-id="90a38-199">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="update-the-server-project-of-a-hosted-blazor-solution"></a><span data-ttu-id="90a38-200">Aktualisieren des Server Projekts einer gehosteten Blazor Lösung</span><span class="sxs-lookup"><span data-stu-id="90a38-200">Update the Server project of a hosted Blazor solution</span></span>

<span data-ttu-id="90a38-201">Befolgen Sie die Anweisungen in den vorangehenden Abschnitten:</span><span class="sxs-lookup"><span data-stu-id="90a38-201">Follow the guidance in the preceding sections:</span></span>

* [<span data-ttu-id="90a38-202">Aktualisieren Blazor WebAssembly und Blazor Server Projekte</span><span class="sxs-lookup"><span data-stu-id="90a38-202">Update Blazor WebAssembly and Blazor Server projects</span></span>](#update-blazor-webassembly-and-blazor-server-projects)
* [<span data-ttu-id="90a38-203">Aktualisieren von Blazor WebAssembly Projekten</span><span class="sxs-lookup"><span data-stu-id="90a38-203">Update Blazor WebAssembly projects</span></span>](#update-blazor-webassembly-projects)
* <span data-ttu-id="90a38-204">Der Abschnitt, der für den Anbieter der APP mit Azure Active Directory gilt:</span><span class="sxs-lookup"><span data-stu-id="90a38-204">The section that applies to the app's provider with Azure Active Directory:</span></span>
  * [<span data-ttu-id="90a38-205">Eigenständige Blazor WebAssembly App mit Microsoft-Konten</span><span class="sxs-lookup"><span data-stu-id="90a38-205">Standalone Blazor WebAssembly app with Microsoft Accounts</span></span>](#standalone-blazor-webassembly-app-with-microsoft-accounts)
  * [<span data-ttu-id="90a38-206">Eigenständige Blazor WebAssembly App mit Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="90a38-206">Standalone Blazor WebAssembly app with Azure Active Directory (AAD)</span></span>](#standalone-blazor-webassembly-app-with-azure-active-directory-aad)
  * [<span data-ttu-id="90a38-207">Eigenständige Blazor WebAssembly App mit Azure Active Directory (AAD) B2C</span><span class="sxs-lookup"><span data-stu-id="90a38-207">Standalone Blazor WebAssembly app with Azure Active Directory (AAD) B2C</span></span>](#standalone-blazor-webassembly-app-with-azure-active-directory-aad-b2c)

<span data-ttu-id="90a38-208">Aktualisieren Sie das *`Server`* Projekt einer gehosteten Blazor Lösung als ASP.net Core-APP, indem Sie die allgemeine Anleitung in diesem Artikel befolgen.</span><span class="sxs-lookup"><span data-stu-id="90a38-208">Update the *`Server`* project of a hosted Blazor solution as an ASP.NET Core app following the general guidance in this article.</span></span>

<span data-ttu-id="90a38-209">Außerdem *`Server`* sollten Projekte, die Benutzer für Client- Blazor WebAssembly apps mit Azure Active Directory (AAD) oder B2C authentifizieren, neue Microsoft Identity v 2.0-Pakete übernehmen:</span><span class="sxs-lookup"><span data-stu-id="90a38-209">Additionally, *`Server`* projects that authenticate users to client Blazor WebAssembly apps with Azure Active Directory (AAD) or B2C should adopt new Microsoft Identity v2.0 packages:</span></span> 
  
<span data-ttu-id="90a38-210">Für Aad:</span><span class="sxs-lookup"><span data-stu-id="90a38-210">For AAD:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureAD.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="{VERSION}" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="{VERSION}" />
```

<span data-ttu-id="90a38-211">Aad B2C:</span><span class="sxs-lookup"><span data-stu-id="90a38-211">For AAD B2C:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureADB2C.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="{VERSION}" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="{VERSION}" />
```

<span data-ttu-id="90a38-212">Bestimmen Sie für die vorangehenden Paket Verweise die Paketversionen für die `{VERSION}` Platzhalter unter NuGet.org:</span><span class="sxs-lookup"><span data-stu-id="90a38-212">For the preceding package references, determine the package versions for the `{VERSION}` placeholders at NuGet.org:</span></span>

* [`Microsoft.Identity.Web`](https://www.nuget.org/packages/Microsoft.Identity.Web)
* [`Microsoft.Identity.Web.UI`](https://www.nuget.org/packages/Microsoft.Identity.Web.UI)

> [!NOTE]
> <span data-ttu-id="90a38-213">Das SDK des *`Server`* Projekts in einer gehosteten Blazor WebAssembly Lösung bleibt bestehen `Microsoft.NET.Sdk.Web` :</span><span class="sxs-lookup"><span data-stu-id="90a38-213">The SDK of the *`Server`* project in a hosted Blazor WebAssembly solution remains `Microsoft.NET.Sdk.Web`:</span></span>
>
> ```xml
> <Project Sdk="Microsoft.NET.Sdk.Web">
> ```

<span data-ttu-id="90a38-214">Weitere Informationen finden Sie in folgenden Quellen:</span><span class="sxs-lookup"><span data-stu-id="90a38-214">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="clean-and-rebuild-the-solution"></a><span data-ttu-id="90a38-215">Bereinigen und Neuerstellen der Projekt Mappe</span><span class="sxs-lookup"><span data-stu-id="90a38-215">Clean and rebuild the solution</span></span>

<span data-ttu-id="90a38-216">Nachdem Sie die APP oder Lösung zu .net 5 migriert haben, müssen Sie die APP oder Projekt Mappe bereinigen und neu erstellen</span><span class="sxs-lookup"><span data-stu-id="90a38-216">After migrating the app or solution to .NET 5, clean and rebuild the app or solution.</span></span> <span data-ttu-id="90a38-217">Wenn Paket Inkompatibilitäten zwischen neuen Paket verweisen und zwischengespeicherten Paketen vorhanden sind:</span><span class="sxs-lookup"><span data-stu-id="90a38-217">If package incompatibilities exist between new package references and cached packages:</span></span>

1. <span data-ttu-id="90a38-218">Löschen Sie die nuget-Paket Caches, indem Sie den folgenden [`dotnet nuget locals`](/dotnet/core/tools/dotnet-nuget-locals) Befehl in einer Befehlsshell ausführen:</span><span class="sxs-lookup"><span data-stu-id="90a38-218">Clear NuGet package caches by executing the following [`dotnet nuget locals`](/dotnet/core/tools/dotnet-nuget-locals) command in a command shell:</span></span>

   ```dotnetcli
   dotnet nuget locals --clear all
   ```
   
1. <span data-ttu-id="90a38-219">Bereinigen und erneutes Erstellen der APP oder Projekt Mappe.</span><span class="sxs-lookup"><span data-stu-id="90a38-219">Clean and rebuild the app or solution.</span></span>

### <a name="troubleshoot"></a><span data-ttu-id="90a38-220">Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="90a38-220">Troubleshoot</span></span>

<span data-ttu-id="90a38-221">Befolgen Sie *die Anleitung zur* Problembehandlung am Ende des Blazor WebAssembly Sicherheits Themas, das für Ihre APP gilt:</span><span class="sxs-lookup"><span data-stu-id="90a38-221">Follow the *Troubleshoot* guidance at the end of the Blazor WebAssembly security topic that applies to your app:</span></span>

<span data-ttu-id="90a38-222">Eigenständige Blazor WebAssembly-Apps:</span><span class="sxs-lookup"><span data-stu-id="90a38-222">Standalone Blazor WebAssembly apps:</span></span>

* [<span data-ttu-id="90a38-223">Allgemeiner Leitfaden für OIDC-Anbieter und die WebAssembly-Authentifizierungsbibliothek</span><span class="sxs-lookup"><span data-stu-id="90a38-223">General guidance for OIDC providers and the WebAssembly Authentication Library</span></span>](xref:blazor/security/webassembly/standalone-with-authentication-library)
* [<span data-ttu-id="90a38-224">Microsoft-Konten</span><span class="sxs-lookup"><span data-stu-id="90a38-224">Microsoft Accounts</span></span>](xref:blazor/security/webassembly/standalone-with-microsoft-accounts)
* [<span data-ttu-id="90a38-225">Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="90a38-225">Azure Active Directory (AAD)</span></span>](xref:blazor/security/webassembly/standalone-with-azure-active-directory)
* [<span data-ttu-id="90a38-226">Azure Active Directory (AAD) B2C</span><span class="sxs-lookup"><span data-stu-id="90a38-226">Azure Active Directory (AAD) B2C</span></span>](xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c)

<span data-ttu-id="90a38-227">Gehostete Blazor WebAssembly-Apps:</span><span class="sxs-lookup"><span data-stu-id="90a38-227">Hosted Blazor WebAssembly apps:</span></span>

* [<span data-ttu-id="90a38-228">Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="90a38-228">Azure Active Directory (AAD)</span></span>](xref:blazor/security/webassembly/hosted-with-azure-active-directory)
* [<span data-ttu-id="90a38-229">Azure Active Directory (AAD) B2C</span><span class="sxs-lookup"><span data-stu-id="90a38-229">Azure Active Directory (AAD) B2C</span></span>](xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c)
* [<span data-ttu-id="90a38-230">Identity Server</span><span class="sxs-lookup"><span data-stu-id="90a38-230">Identity Server</span></span>](xref:blazor/security/webassembly/hosted-with-identity-server)

### <a name="unauthorized-client-for-azure-active-directory-aad"></a><span data-ttu-id="90a38-231">Nicht autorisierter Client für Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="90a38-231">Unauthorized client for Azure Active Directory (AAD)</span></span>

<span data-ttu-id="90a38-232">Nach dem Upgrade einer Blazor WebAssembly app, die Aad für die Authentifizierung verwendet, erhalten Sie möglicherweise die folgende Fehlermeldung für den Anmelde Rückruf an die APP, nachdem sich der Benutzer mit Aad angemeldet hat:</span><span class="sxs-lookup"><span data-stu-id="90a38-232">After upgrading a Blazor WebAssembly app that uses AAD for authentication, you may receive the following error on the login callback to the app after the user signs in with AAD:</span></span>

> <span data-ttu-id="90a38-233">Info: Die Autorisierung von Microsoft.AspNetCore.Authorization.DefaultAuthorizationService[2] Authorization ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="90a38-233">info: Microsoft.AspNetCore.Authorization.DefaultAuthorizationService[2] Authorization failed.</span></span> <span data-ttu-id="90a38-234">Diese Anforderungen wurden nicht erfüllt: DenyAnonymousAuthorizationRequirement: Erfordert einen authentifizierten Benutzer.</span><span class="sxs-lookup"><span data-stu-id="90a38-234">These requirements were not met: DenyAnonymousAuthorizationRequirement: Requires an authenticated user.</span></span>

<span data-ttu-id="90a38-235">Anmelderückruffehler von AAD:</span><span class="sxs-lookup"><span data-stu-id="90a38-235">Login callback error from AAD:</span></span>

* <span data-ttu-id="90a38-236">Fehler: `unauthorized_client`</span><span class="sxs-lookup"><span data-stu-id="90a38-236">Error: `unauthorized_client`</span></span>
* <span data-ttu-id="90a38-237">Description (Beschreibung): `AADB2C90058: The provided application is not configured to allow public clients.`</span><span class="sxs-lookup"><span data-stu-id="90a38-237">Description: `AADB2C90058: The provided application is not configured to allow public clients.`</span></span>

<span data-ttu-id="90a38-238">So beheben Sie den Fehler</span><span class="sxs-lookup"><span data-stu-id="90a38-238">To resolve the error:</span></span>

1. <span data-ttu-id="90a38-239">Greifen Sie im Azure-Portal auf das [Manifest der App](/azure/active-directory/develop/reference-app-manifest) zu.</span><span class="sxs-lookup"><span data-stu-id="90a38-239">In the Azure portal, access the [app's manifest](/azure/active-directory/develop/reference-app-manifest).</span></span>
1. <span data-ttu-id="90a38-240">Legen Sie das Attribut [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute) auf `null` oder `true` fest.</span><span class="sxs-lookup"><span data-stu-id="90a38-240">Set the [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute) attribute to `null` or `true`.</span></span>

## <a name="update-a-blazor-progressive-web-application-pwa"></a><span data-ttu-id="90a38-241">Aktualisieren einer Blazor progressiven Webanwendung (PWA)</span><span class="sxs-lookup"><span data-stu-id="90a38-241">Update a Blazor Progressive Web Application (PWA)</span></span>

<span data-ttu-id="90a38-242">Fügen Sie der Projektdatei der PWA-App Folgendes Element hinzu:</span><span class="sxs-lookup"><span data-stu-id="90a38-242">Add the following item to the PWA app's project file:</span></span>

```xml
<ItemGroup>
  <ServiceWorker Include="wwwroot\service-worker.js" 
    PublishedContent="wwwroot\service-worker.published.js" />
</ItemGroup>
```

## <a name="update-razor-class-libraries-rcls"></a><span data-ttu-id="90a38-243">Aktualisieren von Razor Klassenbibliotheken (rcls)</span><span class="sxs-lookup"><span data-stu-id="90a38-243">Update Razor class libraries (RCLs)</span></span>

<span data-ttu-id="90a38-244">Migrieren Sie Razor Klassenbibliotheken (rcls), um neue APIs oder Features zu nutzen, die als Teil von ASP.net Core 5,0 eingeführt werden.</span><span class="sxs-lookup"><span data-stu-id="90a38-244">Migrate Razor class libraries (RCLs) to take advantage of new APIs or features that are introduced as part of ASP.NET Core 5.0.</span></span> 

<span data-ttu-id="90a38-245">So aktualisieren Sie eine RCL-Zielkomponente:</span><span class="sxs-lookup"><span data-stu-id="90a38-245">To update a RCL that targets components:</span></span>

1. <span data-ttu-id="90a38-246">Aktualisieren Sie die folgenden Eigenschaften in der Projektdatei:</span><span class="sxs-lookup"><span data-stu-id="90a38-246">Update the following properties in the project file:</span></span>

   ```diff
   <Project Sdk="Microsoft.NET.Sdk.Razor">
    
     <PropertyGroup>
   -     <TargetFramework>netstandard2.0</TargetFramework>
   -     <RazorLangVersion>3.0</RazorLangVersion>
   +     <TargetFramework>net5.0</TargetFramework>
     </PropertyGroup>
   ```

1. <span data-ttu-id="90a38-247">Aktualisieren Sie andere Pakete auf die neuesten Versionen.</span><span class="sxs-lookup"><span data-stu-id="90a38-247">Update other packages to their latest versions.</span></span> <span data-ttu-id="90a38-248">Die neuesten Versionen finden Sie unter [NuGet.org](https://www.nuget.org).</span><span class="sxs-lookup"><span data-stu-id="90a38-248">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

<span data-ttu-id="90a38-249">Aktualisieren Sie die folgenden Eigenschaften in der Projektdatei, um eine RCL zu aktualisieren, die auf MVC ausgerichtet ist:</span><span class="sxs-lookup"><span data-stu-id="90a38-249">To update an RCL targeting MVC, update the following properties in the project file:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Razor">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
    <AddRazorSupportForMvc>true</AddRazorSupportForMvc>
  </PropertyGroup>
```

## <a name="update-package-references"></a><span data-ttu-id="90a38-250">Aktualisieren von Paketverweisen</span><span class="sxs-lookup"><span data-stu-id="90a38-250">Update package references</span></span>

<span data-ttu-id="90a38-251">Aktualisieren Sie in der Projektdatei alle [Microsoft. aspnetcore. \*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft. entityframeworkcore. \*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft. Extensions. \*](https://www.nuget.org/packages?q=Microsoft.Extensions.*), und [System.Net.Http.Jsauf](https://www.nuget.org/packages/System.Net.Http.Json) das Attribut des Paket Verweises auf `Version` 5.0.0 oder höher.</span><span class="sxs-lookup"><span data-stu-id="90a38-251">In the project file, update each [Microsoft.AspNetCore.\*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft.EntityFrameworkCore.\*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft.Extensions.\*](https://www.nuget.org/packages?q=Microsoft.Extensions.*), and [System.Net.Http.Json](https://www.nuget.org/packages/System.Net.Http.Json) package reference's `Version` attribute to 5.0.0 or later.</span></span> <span data-ttu-id="90a38-252">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="90a38-252">For example:</span></span>

```diff
<ItemGroup>
-    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="3.1.6" />
-    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="3.1.6">
-    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="3.1.6" />
-    <PackageReference Include="System.Net.Http.Json" Version="3.2.1" />
+    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="5.0.0" />
+    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="5.0.0">
+    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="5.0.0" />
+    <PackageReference Include="System.Net.Http.Json" Version="5.0.0" />
</ItemGroup>
```

## <a name="update-docker-images"></a><span data-ttu-id="90a38-253">Aktualisieren von Docker-Images</span><span class="sxs-lookup"><span data-stu-id="90a38-253">Update Docker images</span></span>

<span data-ttu-id="90a38-254">Aktualisieren Sie die *dockerfile* `FROM` -Anweisungen und-Skripts für apps, die Docker verwenden.</span><span class="sxs-lookup"><span data-stu-id="90a38-254">For apps using Docker, update your *Dockerfile* `FROM` statements and scripts.</span></span> <span data-ttu-id="90a38-255">Verwenden Sie ein Basis Image, das den ASP.net Core 5,0-Lauf Zeit Modul einschließt.</span><span class="sxs-lookup"><span data-stu-id="90a38-255">Use a base image that includes the ASP.NET Core 5.0 runtime.</span></span> <span data-ttu-id="90a38-256">Beachten Sie den folgenden `docker pull` Befehls Unterschied zwischen ASP.net Core 3,1 und 5,0:</span><span class="sxs-lookup"><span data-stu-id="90a38-256">Consider the following `docker pull` command difference between ASP.NET Core 3.1 and 5.0:</span></span>

```diff
- docker pull mcr.microsoft.com/dotnet/core/aspnet:3.1
+ docker pull mcr.microsoft.com/dotnet/aspnet:5.0
```

<span data-ttu-id="90a38-257">Im Rahmen der Umstellung auf ".net" als Produktname wurden die Docker-Images aus den `mcr.microsoft.com/dotnet/core` Depots in verschoben `mcr.microsoft.com/dotnet` .</span><span class="sxs-lookup"><span data-stu-id="90a38-257">As part of the move to ".NET" as the product name, the Docker images moved from the `mcr.microsoft.com/dotnet/core` repositories to `mcr.microsoft.com/dotnet`.</span></span> <span data-ttu-id="90a38-258">Weitere Informationen finden Sie unter [dotnet/dotnet-docker # 1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span><span class="sxs-lookup"><span data-stu-id="90a38-258">For more information, see [dotnet/dotnet-docker#1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span></span>

## <a name="model-binding-changes-in-aspnet-core-mvc-and-razor-pages"></a><span data-ttu-id="90a38-259">Änderungen an der Modell Bindung in ASP.net Core MVC und Razor Seiten</span><span class="sxs-lookup"><span data-stu-id="90a38-259">Model binding changes in ASP.NET Core MVC and Razor Pages</span></span>

### <a name="datetime-values-are-model-bound-as-utc-times"></a><span data-ttu-id="90a38-260">DateTime-Werte sind als UTC-Zeitmodell gebunden.</span><span class="sxs-lookup"><span data-stu-id="90a38-260">DateTime values are model bound as UTC times</span></span>

<span data-ttu-id="90a38-261">In ASP.net Core 3,1 und früheren Versionen `DateTime` Warenwerte Modell gebunden als lokale Zeit, in der die Zeitzone vom Server bestimmt wurde.</span><span class="sxs-lookup"><span data-stu-id="90a38-261">In ASP.NET Core 3.1 and earlier, `DateTime` values were model-bound as local time, where the timezone was determined by the server.</span></span> <span data-ttu-id="90a38-262">`DateTime` Werte, die von der Eingabe Formatierung (JSON) und den Werten gebunden sind, `DateTimeOffset` wurden als UTC-Zeit Zonen gebunden.</span><span class="sxs-lookup"><span data-stu-id="90a38-262">`DateTime` values bound from input formatting (JSON) and `DateTimeOffset` values were bound as UTC timezones.</span></span>

<span data-ttu-id="90a38-263">In ASP.net Core 5,0 und höher bindet die Modell Bindung `DateTime` die Werte konsistent an die UTC-Zeitzone.</span><span class="sxs-lookup"><span data-stu-id="90a38-263">In ASP.NET Core 5.0 and later, model binding consistently binds `DateTime` values with the UTC timezone.</span></span>

<span data-ttu-id="90a38-264">Wenn Sie das vorherige Verhalten beibehalten möchten, entfernen Sie das `DateTimeModelBinderProvider` in `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="90a38-264">To retain the previous behavior, remove the `DateTimeModelBinderProvider` in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddControllersWithViews(options => 
    options.ModelBinderProviders.RemoveType<DateTimeModelBinderProvider>());
```

### <a name="complexobjectmodelbinderprovider--complexobjectmodelbinder-replace-complextypemodelbinderprovider--complextypemodelbinder"></a><span data-ttu-id="90a38-265">Complexobjectmodelbinderprovider \ complexobjectmodelbinder Replace complextypemodelbinderprovider \ complextypemodelbinder</span><span class="sxs-lookup"><span data-stu-id="90a38-265">ComplexObjectModelBinderProvider \ ComplexObjectModelBinder replace ComplexTypeModelBinderProvider \ ComplexTypeModelBinder</span></span>

<span data-ttu-id="90a38-266">Zum Hinzufügen der Unterstützung für Modell Bindung [c# 9-Daten Satz Typen](/dotnet/csharp/whats-new/csharp-9#record-types) <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> ist:</span><span class="sxs-lookup"><span data-stu-id="90a38-266">To add support for model binding [C# 9 record types](/dotnet/csharp/whats-new/csharp-9#record-types), the <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> is:</span></span>

* <span data-ttu-id="90a38-267">Als veraltet gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="90a38-267">Annotated as obsolete.</span></span>
* <span data-ttu-id="90a38-268">Nicht mehr standardmäßig registriert.</span><span class="sxs-lookup"><span data-stu-id="90a38-268">No longer registered by default.</span></span>

<span data-ttu-id="90a38-269">Apps, die auf dem vorhanden sein von in der-Auflistung basieren, `ComplexTypeModelBinderProvider` `ModelBinderProviders` müssen auf den neuen Binder Anbieter verweisen:</span><span class="sxs-lookup"><span data-stu-id="90a38-269">Apps that rely on the presence of the `ComplexTypeModelBinderProvider` in the `ModelBinderProviders` collection need to reference the new binder provider:</span></span>

```diff
- var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexTypeModelBinderProvider>();
+ var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexObjectModelBinderProvider>();
```

## <a name="usedatabaseerrorpage-obsolete"></a><span data-ttu-id="90a38-270">Usedatabaseerrorpage veraltet</span><span class="sxs-lookup"><span data-stu-id="90a38-270">UseDatabaseErrorPage obsolete</span></span>

<span data-ttu-id="90a38-271">Die ASP.net Core 3,1-Vorlagen, die eine Option für einzelne Benutzerkonten enthalten, generieren einen-Rückruf <xref:Microsoft.AspNetCore.Builder.DatabaseErrorPageExtensions.UseDatabaseErrorPage%2A> .</span><span class="sxs-lookup"><span data-stu-id="90a38-271">The ASP.NET Core 3.1 templates that include an option for individual user accounts generate a call to <xref:Microsoft.AspNetCore.Builder.DatabaseErrorPageExtensions.UseDatabaseErrorPage%2A>.</span></span> <span data-ttu-id="90a38-272">`UseDatabaseErrorPage` ist mittlerweile veraltet und sollte durch eine Kombination von und ersetzt werden `AddDatabaseDeveloperPageExceptionFilter` `UseMigrationsEndPoint` , wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="90a38-272">`UseDatabaseErrorPage` is now obsolete and should be replaced with a combination of `AddDatabaseDeveloperPageExceptionFilter` and `UseMigrationsEndPoint`, as shown in the following code:</span></span>

```diff
public void ConfigureServices(IServiceCollection services)
{
    services.AddDbContext<ApplicationDbContext>(options =>
        options.UseSqlServer(
            Configuration.GetConnectionString("DefaultConnection")));
+   services.AddDatabaseDeveloperPageExceptionFilter();
    services.AddDefaultIdentity<IdentityUser>(options => options.SignIn.RequireConfirmedAccount = true)
        .AddEntityFrameworkStores<ApplicationDbContext>();
    services.AddRazorPages();
}

public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
+       app.UseMigrationsEndPoint();
-       app.UseDatabaseErrorPage();
    }
    else
    {
        app.UseExceptionHandler("/Error");
        app.UseHsts();
    }
```

<span data-ttu-id="90a38-273">Weitere Informationen finden Sie in [diesem GitHub-Issue](https://github.com/dotnet/aspnetcore/issues/24987).</span><span class="sxs-lookup"><span data-stu-id="90a38-273">For more information, see [this GitHub issue](https://github.com/dotnet/aspnetcore/issues/24987).</span></span>

## <a name="review-breaking-changes"></a><span data-ttu-id="90a38-274">Wichtige Änderungen überprüfen</span><span class="sxs-lookup"><span data-stu-id="90a38-274">Review breaking changes</span></span>

<span data-ttu-id="90a38-275">Grundlegende Änderungen von .net Core 3,1 auf .net 5,0 finden Sie unter [Breaking Changes for Migration from Version 3,1 to 5,0](/dotnet/core/compatibility/3.1-5.0).</span><span class="sxs-lookup"><span data-stu-id="90a38-275">For breaking changes from .NET Core 3.1 to .NET 5.0, see [Breaking changes for migration from version 3.1 to 5.0](/dotnet/core/compatibility/3.1-5.0).</span></span> <span data-ttu-id="90a38-276">ASP.net Core und Entity Framework Core sind auch in der Liste enthalten.</span><span class="sxs-lookup"><span data-stu-id="90a38-276">ASP.NET Core and Entity Framework Core are also included in the list.</span></span>
