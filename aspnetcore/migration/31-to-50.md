---
title: Migrieren von ASP.net Core 3,1 zu 5,0
author: scottaddie
description: Erfahren Sie, wie Sie ein ASP.net Core 3,1-Projekt zu ASP.net Core 5,0 migrieren.
ms.author: scaddie
ms.custom: mvc
ms.date: 11/17/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: migration/31-to-50
ms.openlocfilehash: 9550892f8b8bd9418f26d29ba77a6856a3bb30a0
ms.sourcegitcommit: fb208f907249cc7aab029afff941a0266c187050
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/17/2020
ms.locfileid: "94688383"
---
# <a name="migrate-from-aspnet-core-31-to-50"></a><span data-ttu-id="108de-103">Migrieren von ASP.net Core 3,1 zu 5,0</span><span class="sxs-lookup"><span data-stu-id="108de-103">Migrate from ASP.NET Core 3.1 to 5.0</span></span>

<span data-ttu-id="108de-104">Von [Scott Addie](https://github.com/scottaddie)</span><span class="sxs-lookup"><span data-stu-id="108de-104">By [Scott Addie](https://github.com/scottaddie)</span></span>

<span data-ttu-id="108de-105">In diesem Artikel wird erläutert, wie ein vorhandenes ASP.net Core 3,1-Projekt auf ASP.net Core 5,0 aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="108de-105">This article explains how to update an existing ASP.NET Core 3.1 project to ASP.NET Core 5.0.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="108de-106">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="108de-106">Prerequisites</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="108de-107">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="108de-107">Visual Studio</span></span>](#tab/visual-studio)

[!INCLUDE[](~/includes/net-core-prereqs-vs-5.0.md)]

# <a name="visual-studio-code"></a>[<span data-ttu-id="108de-108">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="108de-108">Visual Studio Code</span></span>](#tab/visual-studio-code)

[!INCLUDE[](~/includes/net-core-prereqs-vsc-5.0.md)]

# <a name="visual-studio-for-mac"></a>[<span data-ttu-id="108de-109">Visual Studio für Mac</span><span class="sxs-lookup"><span data-stu-id="108de-109">Visual Studio for Mac</span></span>](#tab/visual-studio-mac)

[!INCLUDE[](~/includes/net-core-prereqs-mac-5.0.md)]

---

## <a name="update-net-core-sdk-version-in-globaljson"></a><span data-ttu-id="108de-110">Aktualisieren der .NET Core SDK-Version in „global.json“</span><span class="sxs-lookup"><span data-stu-id="108de-110">Update .NET Core SDK version in global.json</span></span>

<span data-ttu-id="108de-111">Wenn Sie sich für eine bestimmte .net Core SDK Version auf eine [global.jsin](/dotnet/core/tools/global-json) der Datei verlassen, aktualisieren Sie die `version` -Eigenschaft auf die installierte Version von .net 5,0 SDK.</span><span class="sxs-lookup"><span data-stu-id="108de-111">If you rely upon a [global.json](/dotnet/core/tools/global-json) file to target a specific .NET Core SDK version, update the `version` property to the .NET 5.0 SDK version that's installed.</span></span> <span data-ttu-id="108de-112">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="108de-112">For example:</span></span>

```diff
{
  "sdk": {
-    "version": "3.1.200"
+    "version": "5.0.100"
  }
}
```

## <a name="update-the-target-framework"></a><span data-ttu-id="108de-113">Aktualisieren des Ziel Frameworks</span><span class="sxs-lookup"><span data-stu-id="108de-113">Update the target framework</span></span>

<span data-ttu-id="108de-114">Wenn Sie ein Blazor WebAssembly Projekt aktualisieren, fahren Sie mit dem Abschnitt [ Blazor WebAssembly Projekte aktualisieren](#update-blazor-webassembly-projects) fort.</span><span class="sxs-lookup"><span data-stu-id="108de-114">If updating a Blazor WebAssembly project, skip to the [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) section.</span></span> <span data-ttu-id="108de-115">Für alle anderen ASP.net Core Projekttyp aktualisieren Sie den [zielframeworkmoniker (TFM)](/dotnet/standard/frameworks) der Projektdatei auf Folgendes `net5.0` :</span><span class="sxs-lookup"><span data-stu-id="108de-115">For any other ASP.NET Core project type, update the project file's [Target Framework Moniker (TFM)](/dotnet/standard/frameworks) to `net5.0`:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
  </PropertyGroup>

</Project>
```

## <a name="update-no-locblazor-webassembly-and-no-locblazor-server-projects"></a><span data-ttu-id="108de-116">Aktualisieren Blazor WebAssembly und Blazor Server Projekte</span><span class="sxs-lookup"><span data-stu-id="108de-116">Update Blazor WebAssembly and Blazor Server projects</span></span>

<span data-ttu-id="108de-117">*Die Anleitungen in diesem Abschnitt gelten für beide Blazor Hostingmodelle. In den Abschnitten dieses Abschnitts finden Sie zusätzliche Anleitungen für das Hosting von Modellen und App-Typen. Wenden Sie den guidnace aus allen relevanten Abschnitten auf Ihre APP an.*</span><span class="sxs-lookup"><span data-stu-id="108de-117">*The guidance in this section applies to both Blazor hosting models. Sections following this section provide additional guidance specific to hosting models and app types. Apply the guidnace from all relevant sections to your app.*</span></span>

1. <span data-ttu-id="108de-118">`wwwroot/index.html`Fügen Sie in einer- Blazor WebAssembly app oder einer- `Pages/_Host.cshtml` Blazor Server App dem- `<link>` Element für Stile ein-Element hinzu `<head>` .</span><span class="sxs-lookup"><span data-stu-id="108de-118">In `wwwroot/index.html` of a Blazor WebAssembly app or the `Pages/_Host.cshtml` of a Blazor Server app, add a `<link>` element to the `<head>` element for styles.</span></span> <span data-ttu-id="108de-119">In den folgenden `<link>` Element `href` Attributwerten ist der Platzhalter `{ASSEMBLY NAME}` der AssemblyName der app.</span><span class="sxs-lookup"><span data-stu-id="108de-119">In the following `<link>` element `href` attribute values, the placeholder `{ASSEMBLY NAME}` is the app's assembly name.</span></span>

    ```diff
    +<link href="{ASSEMBLY NAME}.styles.css" rel="stylesheet" />
    ```
    
    <span data-ttu-id="108de-120">Eigenständiges Blazor WebAssembly Beispiel:</span><span class="sxs-lookup"><span data-stu-id="108de-120">Standalone Blazor WebAssembly example:</span></span>
    
    ```diff
    +<link href="BlazorSample.styles.css" rel="stylesheet" />
    ```

    <span data-ttu-id="108de-121">*`Client`* Projekt eines gehosteten Blazor WebAssembly Lösungs Beispiels:</span><span class="sxs-lookup"><span data-stu-id="108de-121">*`Client`* project of a hosted Blazor WebAssembly solution example:</span></span>
    
    ```diff
    +<link href="BlazorSample.Client.styles.css" rel="stylesheet" />
    ```

1. <span data-ttu-id="108de-122">Umgeben Sie in der- `Shared/MainLayout.razor` Datei den gesamten Inhalt eines- `<div>` Elements mit dem `class` von `page` :</span><span class="sxs-lookup"><span data-stu-id="108de-122">In the `Shared/MainLayout.razor` file, surround all of the content in a `<div>` element with an `class` of `page`:</span></span>

    ```razor
    <div class="page">
    
        ...
        
    </div>
    ```
    
1. <span data-ttu-id="108de-123">Fügen Sie dem Ordner die folgenden Dateien hinzu `Shared` :</span><span class="sxs-lookup"><span data-stu-id="108de-123">Add the following files to the `Shared` folder:</span></span>

    <span data-ttu-id="108de-124">`MainLayout.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="108de-124">`MainLayout.razor.css`:</span></span>
    
    ```css
    .page {
        position: relative;
        display: flex;
        flex-direction: column;
    }

    .main {
        flex: 1;
    }

    .sidebar {
        background-image: linear-gradient(180deg, rgb(5, 39, 103) 0%, #3a0647 70%);
    }

    .top-row {
        background-color: #f7f7f7;
        border-bottom: 1px solid #d6d5d5;
        justify-content: flex-end;
        height: 3.5rem;
        display: flex;
        align-items: center;
    }

        .top-row ::deep a, .top-row .btn-link {
            white-space: nowrap;
            margin-left: 1.5rem;
        }

        .top-row a:first-child {
            overflow: hidden;
            text-overflow: ellipsis;
        }

    @media (max-width: 767.98px) {
        .top-row:not(.auth) {
            display: none;
        }

        .top-row.auth {
            justify-content: space-between;
        }

        .top-row a, .top-row .btn-link {
            margin-left: 0;
        }
    }

    @media (min-width: 768px) {
        .page {
            flex-direction: row;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            position: sticky;
            top: 0;
        }

        .top-row {
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .main > div {
            padding-left: 2rem !important;
            padding-right: 1.5rem !important;
        }
    }
    ```
    
    <span data-ttu-id="108de-125">`NavMenu.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="108de-125">`NavMenu.razor.css`:</span></span>
    
    ```css
    .navbar-toggler {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .top-row {
        height: 3.5rem;
        background-color: rgba(0,0,0,0.4);
    }

    .navbar-brand {
        font-size: 1.1rem;
    }

    .oi {
        width: 2rem;
        font-size: 1.1rem;
        vertical-align: text-top;
        top: -2px;
    }

    .nav-item {
        font-size: 0.9rem;
        padding-bottom: 0.5rem;
    }

        .nav-item:first-of-type {
            padding-top: 1rem;
        }

        .nav-item:last-of-type {
            padding-bottom: 1rem;
        }

        .nav-item ::deep a {
            color: #d7d7d7;
            border-radius: 4px;
            height: 3rem;
            display: flex;
            align-items: center;
            line-height: 3rem;
        }

    .nav-item ::deep a.active {
        background-color: rgba(255,255,255,0.25);
        color: white;
    }

    .nav-item ::deep a:hover {
        background-color: rgba(255,255,255,0.1);
        color: white;
    }

    @media (min-width: 768px) {
        .navbar-toggler {
            display: none;
        }

        .collapse {
            /* Never collapse the sidebar for wide screens */
            display: block;
        }
    }
    ```

1. <span data-ttu-id="108de-126">Die neueste Basis `wwwroot/css/app.css` Datei einer APP Blazor WebAssembly oder einer `wwwroot/css/site.css` Datei einer Blazor Server app enthält die folgenden Stile.</span><span class="sxs-lookup"><span data-stu-id="108de-126">The latest base `wwwroot/css/app.css` file of a Blazor WebAssembly app or `wwwroot/css/site.css` file of a Blazor Server app includes the following styles.</span></span> <span data-ttu-id="108de-127">Entfernen Sie zusätzliche Stile, und übernehmen Sie die folgenden Stile und alle, die Sie der app hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="108de-127">Remove extra styles leaving the following styles and any that you've added to the app.</span></span>

    <span data-ttu-id="108de-128">Das folgende Stylesheet umfasst nur Basis Stile und enthält **keine** benutzerdefinierten Stile, die vom Entwickler hinzugefügt wurden:</span><span class="sxs-lookup"><span data-stu-id="108de-128">The following stylesheet only includes base styles and does **not** include custom styles added by the developer:</span></span>
   
    ```css
    @import url('open-iconic/font/css/open-iconic-bootstrap.min.css');

    html, body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

    a, .btn-link {
        color: #0366d6;
    }

    .btn-primary {
        color: #fff;
        background-color: #1b6ec2;
        border-color: #1861ac;
    }

    .content {
        padding-top: 1.1rem;
    }

    .valid.modified:not([type=checkbox]) {
        outline: 1px solid #26b050;
    }

    .invalid {
        outline: 1px solid red;
    }

    .validation-message {
        color: red;
    }

    #blazor-error-ui {
        background: lightyellow;
        bottom: 0;
        box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.2);
        display: none;
        left: 0;
        padding: 0.6rem 1.25rem 0.7rem 1.25rem;
        position: fixed;
        width: 100%;
        z-index: 1000;
    }

    #blazor-error-ui .dismiss {
        cursor: pointer;
        position: absolute;
        right: 0.75rem;
        top: 0.5rem;
    }
    ```

## <a name="update-no-locblazor-webassembly-projects"></a><span data-ttu-id="108de-129">Aktualisieren von Blazor WebAssembly Projekten</span><span class="sxs-lookup"><span data-stu-id="108de-129">Update Blazor WebAssembly projects</span></span>

<span data-ttu-id="108de-130">Blazor WebAssemblyWenden Sie für ein Projekt, einschließlich des *`Client`* Projekts einer gehosteten Blazor Lösung, die folgenden Änderungen auf die Projektdatei an:</span><span class="sxs-lookup"><span data-stu-id="108de-130">For a Blazor WebAssembly project, including the *`Client`* project of a hosted Blazor solution, apply the following changes to the project file:</span></span>

1. <span data-ttu-id="108de-131">Aktualisieren Sie das SDK von `Microsoft.NET.Sdk.Web` auf `Microsoft.NET.Sdk.BlazorWebAssembly` :</span><span class="sxs-lookup"><span data-stu-id="108de-131">Update the SDK from `Microsoft.NET.Sdk.Web` to `Microsoft.NET.Sdk.BlazorWebAssembly`:</span></span>

    ```diff
    - <Project Sdk="Microsoft.NET.Sdk.Web">
    + <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    ```
    
    > [!NOTE]
    > <span data-ttu-id="108de-132">Dieses Update gilt nur für eigenständige Blazor WebAssembly Projekte und die *`Client`* Projekte gehosteter Blazor Lösungen.</span><span class="sxs-lookup"><span data-stu-id="108de-132">This update only applies to standalone Blazor WebAssembly projects and the *`Client`* projects of hosted Blazor solutions.</span></span>

1. <span data-ttu-id="108de-133">Aktualisieren Sie die folgenden Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="108de-133">Update the following properties:</span></span>

    ```diff
    <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    
      <PropertyGroup>
    -     <TargetFramework>netstandard2.1</TargetFramework>
    -     <RazorLangVersion>3.0</RazorLangVersion>
    +     <TargetFramework>net5.0</TargetFramework>
      </PropertyGroup>
    ```

1. <span data-ttu-id="108de-134">Entfernen Sie den Paket Verweis auf [Microsoft. aspnetcore. Components. Webassembly. Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build):</span><span class="sxs-lookup"><span data-stu-id="108de-134">Remove the package reference to [Microsoft.AspNetCore.Components.WebAssembly.Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build):</span></span>

    ```diff
    <ItemGroup>
    -    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Build" Version="3.2.1" PrivateAssets="all" />
    ```

1. <span data-ttu-id="108de-135">Aktualisieren Sie andere Pakete auf die neuesten Versionen.</span><span class="sxs-lookup"><span data-stu-id="108de-135">Update other packages to their latest versions.</span></span> <span data-ttu-id="108de-136">Die neuesten Versionen finden Sie unter [NuGet.org](https://www.nuget.org).</span><span class="sxs-lookup"><span data-stu-id="108de-136">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

1. <span data-ttu-id="108de-137">Ändern Sie in `wwwroot/index.html` das Element, das die `App` Komponente lädt:</span><span class="sxs-lookup"><span data-stu-id="108de-137">In `wwwroot/index.html`, change the element that loads the `App` component:</span></span>
    
    ```diff
    -<app>Loading...</app>
    +<app id="app">Loading...</app>
    ```
    
1. <span data-ttu-id="108de-138">In `Program.Main`:</span><span class="sxs-lookup"><span data-stu-id="108de-138">In `Program.Main`:</span></span>

   * <span data-ttu-id="108de-139">Ändern Sie den Verweis auf das `<app>` Element in einen CSS-Selektor, indem Sie einen Hashwert hinzufügen `#` .</span><span class="sxs-lookup"><span data-stu-id="108de-139">Change the reference to the `<app>` element to a CSS selector by adding a hash `#` to it.</span></span>
   * <span data-ttu-id="108de-140">Ändern `HttpClient` Sie die Registrierung in einen Bereich.</span><span class="sxs-lookup"><span data-stu-id="108de-140">Change the `HttpClient` registration to scoped.</span></span>

    ```diff
    -builder.RootComponents.Add<App>("app");
    +builder.RootComponents.Add<App>("#app");
    
    -builder.Services.AddTransient(sp => new HttpClient 
    -    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
    +builder.Services.AddScoped(sp => new HttpClient 
    +    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
    ```

### <a name="standalone-no-locblazor-webassembly-app-with-microsoft-accounts"></a><span data-ttu-id="108de-141">Eigenständige Blazor WebAssembly App mit Microsoft-Konten</span><span class="sxs-lookup"><span data-stu-id="108de-141">Standalone Blazor WebAssembly app with Microsoft Accounts</span></span>

<span data-ttu-id="108de-142">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) für Microsoft-Konten zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="108de-142">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) for Microsoft Accounts:</span></span>

* <span data-ttu-id="108de-143">Die APP erfordert die `openid` `offline_access` Bereiche und:</span><span class="sxs-lookup"><span data-stu-id="108de-143">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="108de-144">Legen Sie auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** die Platt Form Konfiguration auf **einseitige Anwendung** mit dem Umleitungs-URI der APP fest.</span><span class="sxs-lookup"><span data-stu-id="108de-144">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="108de-145">Deaktivieren Sie auf dem Blatt " **Authentifizierung** " auch die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="108de-145">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="108de-146">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span><span class="sxs-lookup"><span data-stu-id="108de-146">For more information, see <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span></span>

### <a name="standalone-no-locblazor-webassembly-app-with-azure-active-directory-aad"></a><span data-ttu-id="108de-147">Eigenständige Blazor WebAssembly App mit Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="108de-147">Standalone Blazor WebAssembly app with Azure Active Directory (AAD)</span></span>

<span data-ttu-id="108de-148">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="108de-148">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD):</span></span>

* <span data-ttu-id="108de-149">Die APP erfordert den folgenden `https://graph.microsoft.com/User.Read` Bereich:</span><span class="sxs-lookup"><span data-stu-id="108de-149">The app requires the `https://graph.microsoft.com/User.Read` scope:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes
      .Add("https://graph.microsoft.com/User.Read");
  ```
  
* <span data-ttu-id="108de-150">Legen Sie auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** die Platt Form Konfiguration auf **einseitige Anwendung** mit dem Umleitungs-URI der APP fest.</span><span class="sxs-lookup"><span data-stu-id="108de-150">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="108de-151">Deaktivieren Sie auf dem Blatt " **Authentifizierung** " auch die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="108de-151">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>
  
<span data-ttu-id="108de-152">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span><span class="sxs-lookup"><span data-stu-id="108de-152">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span></span>

### <a name="standalone-no-locblazor-app-with-azure-active-directory-aad-b2c"></a><span data-ttu-id="108de-153">Eigenständige Blazor App mit Azure Active Directory (AAD) B2C</span><span class="sxs-lookup"><span data-stu-id="108de-153">Standalone Blazor app with Azure Active Directory (AAD) B2C</span></span>

<span data-ttu-id="108de-154">Für eine eigenständige Blazor WebAssembly app, die im Azure-Portal registriert ist, um Azure Active Directory (AAD) B2C zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="108de-154">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) B2C:</span></span>

* <span data-ttu-id="108de-155">Die APP erfordert die `openid` `offline_access` Bereiche und:</span><span class="sxs-lookup"><span data-stu-id="108de-155">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="108de-156">Legen Sie auf dem Blatt Azure-Portal App-Registrierungs **Authentifizierung** die Platt Form Konfiguration auf **einseitige Anwendung** mit dem Umleitungs-URI der APP fest.</span><span class="sxs-lookup"><span data-stu-id="108de-156">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="108de-157">Deaktivieren Sie auf dem Blatt " **Authentifizierung** " auch die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="108de-157">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="108de-158">Weitere Informationen finden Sie unter <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span><span class="sxs-lookup"><span data-stu-id="108de-158">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span></span>

### <a name="hosted-no-locblazor-webassembly-app-with-azure-active-directory-aad-or-b2c"></a><span data-ttu-id="108de-159">Gehostete Blazor WebAssembly App mit Azure Active Directory (AAD) oder B2C</span><span class="sxs-lookup"><span data-stu-id="108de-159">Hosted Blazor WebAssembly app with Azure Active Directory (AAD) or B2C</span></span>

<span data-ttu-id="108de-160">*`Client`* Bei der APP-Registrierung einer gehosteten Blazor Lösung, die Aad oder Aad B2C für die Benutzerauthentifizierung verwendet, sollte eine **Single-Page-Anwendung** der Azure apps-Platt Form Konfiguration verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="108de-160">The *`Client`* app registration of a hosted Blazor solution that uses AAD or AAD B2C for user authentication should use a **Single-page application** Azure Apps platform configuration:</span></span>

1. <span data-ttu-id="108de-161">Entfernen Sie in der Azure-Portal App-Registrierung für die *`Client`* App die **Webplattform** -Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="108de-161">In the Azure portal app registration for the *`Client`* app, remove the **Web** platform configuration.</span></span>
1. <span data-ttu-id="108de-162">Fügen Sie eine **Einzelseiten-Anwendungs** Platt Form Konfiguration mit dem Umleitungs-URI der APP hinzu.</span><span class="sxs-lookup"><span data-stu-id="108de-162">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
1. <span data-ttu-id="108de-163">Deaktivieren Sie die **implizite Gewährung** für **Zugriffs Token** und **ID-Token**.</span><span class="sxs-lookup"><span data-stu-id="108de-163">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="108de-164">Weitere Informationen finden Sie in folgenden Quellen:</span><span class="sxs-lookup"><span data-stu-id="108de-164">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="update-the-server-project-of-a-hosted-no-locblazor-solution"></a><span data-ttu-id="108de-165">Aktualisieren des Server Projekts einer gehosteten Blazor Lösung</span><span class="sxs-lookup"><span data-stu-id="108de-165">Update the Server project of a hosted Blazor solution</span></span>

<span data-ttu-id="108de-166">Aktualisieren Sie das *`Server`* Projekt einer gehosteten Blazor Lösung als ASP.net Core-APP, indem Sie die allgemeine Anleitung in diesem Artikel befolgen.</span><span class="sxs-lookup"><span data-stu-id="108de-166">Update the *`Server`* project of a hosted Blazor solution as an ASP.NET Core app following the general guidance in this article.</span></span>

<span data-ttu-id="108de-167">Außerdem *`Server`* sollten Projekte, die Benutzer für Client- Blazor WebAssembly apps mit Azure Active Directory (AAD) oder B2C authentifizieren, neue Microsoft Identity v 2.0-Pakete übernehmen:</span><span class="sxs-lookup"><span data-stu-id="108de-167">Additionally, *`Server`* projects that authenticate users to client Blazor WebAssembly apps with Azure Active Directory (AAD) or B2C should adopt new Microsoft Identity v2.0 packages:</span></span> 
  
<span data-ttu-id="108de-168">Für Aad:</span><span class="sxs-lookup"><span data-stu-id="108de-168">For AAD:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureAD.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

<span data-ttu-id="108de-169">Aad B2C:</span><span class="sxs-lookup"><span data-stu-id="108de-169">For AAD B2C:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureADB2C.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

> [!NOTE]
> <span data-ttu-id="108de-170">Das SDK des *`Server`* Projekts in einer gehosteten Blazor WebAssembly Lösung bleibt bestehen `Microsoft.NET.Sdk.Web` :</span><span class="sxs-lookup"><span data-stu-id="108de-170">The SDK of the *`Server`* project in a hosted Blazor WebAssembly solution remains `Microsoft.NET.Sdk.Web`:</span></span>
>
> ```xml
> <Project Sdk="Microsoft.NET.Sdk.Web">
> ```

<span data-ttu-id="108de-171">Weitere Informationen finden Sie in folgenden Quellen:</span><span class="sxs-lookup"><span data-stu-id="108de-171">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="unauthorized-client-for-azure-active-directory-aad"></a><span data-ttu-id="108de-172">Nicht autorisierter Client für Azure Active Directory (AAD)</span><span class="sxs-lookup"><span data-stu-id="108de-172">Unauthorized client for Azure Active Directory (AAD)</span></span>

<span data-ttu-id="108de-173">Nach dem Upgrade einer Blazor WebAssembly app, die Aad für die Authentifizierung verwendet, erhalten Sie möglicherweise die folgende Fehlermeldung für den Anmelde Rückruf an die APP, nachdem sich der Benutzer mit Aad angemeldet hat:</span><span class="sxs-lookup"><span data-stu-id="108de-173">After upgrading a Blazor WebAssembly app that uses AAD for authentication, you may receive the following error on the login callback to the app after the user signs in with AAD:</span></span>

> <span data-ttu-id="108de-174">Info: Die Autorisierung von Microsoft.AspNetCore.Authorization.DefaultAuthorizationService[2] Authorization ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="108de-174">info: Microsoft.AspNetCore.Authorization.DefaultAuthorizationService[2] Authorization failed.</span></span> <span data-ttu-id="108de-175">Diese Anforderungen wurden nicht erfüllt: DenyAnonymousAuthorizationRequirement: Erfordert einen authentifizierten Benutzer.</span><span class="sxs-lookup"><span data-stu-id="108de-175">These requirements were not met: DenyAnonymousAuthorizationRequirement: Requires an authenticated user.</span></span>

<span data-ttu-id="108de-176">Anmelderückruffehler von AAD:</span><span class="sxs-lookup"><span data-stu-id="108de-176">Login callback error from AAD:</span></span>

* <span data-ttu-id="108de-177">Fehler: `unauthorized_client`</span><span class="sxs-lookup"><span data-stu-id="108de-177">Error: `unauthorized_client`</span></span>
* <span data-ttu-id="108de-178">Description (Beschreibung): `AADB2C90058: The provided application is not configured to allow public clients.`</span><span class="sxs-lookup"><span data-stu-id="108de-178">Description: `AADB2C90058: The provided application is not configured to allow public clients.`</span></span>

<span data-ttu-id="108de-179">So beheben Sie den Fehler</span><span class="sxs-lookup"><span data-stu-id="108de-179">To resolve the error:</span></span>

1. <span data-ttu-id="108de-180">Greifen Sie im Azure-Portal auf das [Manifest der App](/azure/active-directory/develop/reference-app-manifest) zu.</span><span class="sxs-lookup"><span data-stu-id="108de-180">In the Azure portal, access the [app's manifest](/azure/active-directory/develop/reference-app-manifest).</span></span>
1. <span data-ttu-id="108de-181">Legen Sie das Attribut [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute) auf `null` oder `true` fest.</span><span class="sxs-lookup"><span data-stu-id="108de-181">Set the [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute) attribute to `null` or `true`.</span></span>

## <a name="update-no-locrazor-class-libraries-rcls"></a><span data-ttu-id="108de-182">Aktualisieren von Razor Klassenbibliotheken (rcls)</span><span class="sxs-lookup"><span data-stu-id="108de-182">Update Razor class libraries (RCLs)</span></span>

<span data-ttu-id="108de-183">Migrieren Sie Razor Klassenbibliotheken (rcls), um neue APIs oder Features zu nutzen, die als Teil von ASP.net Core 5,0 eingeführt werden.</span><span class="sxs-lookup"><span data-stu-id="108de-183">Migrate Razor class libraries (RCLs) to take advantage of new APIs or features that are introduced as part of ASP.NET Core 5.0.</span></span> 

<span data-ttu-id="108de-184">So aktualisieren Sie eine RCL-Zielkomponente:</span><span class="sxs-lookup"><span data-stu-id="108de-184">To update a RCL that targets components:</span></span>

1. <span data-ttu-id="108de-185">Aktualisieren Sie die folgenden Eigenschaften in der Projektdatei:</span><span class="sxs-lookup"><span data-stu-id="108de-185">Update the following properties in the project file:</span></span>

   ```diff
   <Project Sdk="Microsoft.NET.Sdk.Razor">
    
     <PropertyGroup>
   -     <TargetFramework>netstandard2.0</TargetFramework>
   -     <RazorLangVersion>3.0</RazorLangVersion>
   +     <TargetFramework>net5.0</TargetFramework>
     </PropertyGroup>
   ```

1. <span data-ttu-id="108de-186">Aktualisieren Sie andere Pakete auf die neuesten Versionen.</span><span class="sxs-lookup"><span data-stu-id="108de-186">Update other packages to their latest versions.</span></span> <span data-ttu-id="108de-187">Die neuesten Versionen finden Sie unter [NuGet.org](https://www.nuget.org).</span><span class="sxs-lookup"><span data-stu-id="108de-187">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

<span data-ttu-id="108de-188">Aktualisieren Sie die folgenden Eigenschaften in der Projektdatei, um eine RCL zu aktualisieren, die auf MVC ausgerichtet ist:</span><span class="sxs-lookup"><span data-stu-id="108de-188">To update an RCL targeting MVC, update the following properties in the project file:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Razor">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
    <AddRazorSupportForMvc>true</AddRazorSupportForMvc>
  </PropertyGroup>
```

## <a name="update-package-references"></a><span data-ttu-id="108de-189">Aktualisieren von Paketverweisen</span><span class="sxs-lookup"><span data-stu-id="108de-189">Update package references</span></span>

<span data-ttu-id="108de-190">Aktualisieren Sie in der Projektdatei alle [Microsoft. aspnetcore. \*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft. entityframeworkcore. \*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft. Extensions. \*](https://www.nuget.org/packages?q=Microsoft.Extensions.*), und [System.Net.Http.Jsauf](https://www.nuget.org/packages/System.Net.Http.Json) das Attribut des Paket Verweises auf `Version` 5.0.0 oder höher.</span><span class="sxs-lookup"><span data-stu-id="108de-190">In the project file, update each [Microsoft.AspNetCore.\*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft.EntityFrameworkCore.\*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft.Extensions.\*](https://www.nuget.org/packages?q=Microsoft.Extensions.*), and [System.Net.Http.Json](https://www.nuget.org/packages/System.Net.Http.Json) package reference's `Version` attribute to 5.0.0 or later.</span></span> <span data-ttu-id="108de-191">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="108de-191">For example:</span></span>

```diff
<ItemGroup>
-    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="3.1.6" />
-    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="3.1.6">
-    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="3.1.6" />
-    <PackageReference Include="System.Net.Http.Json" Version="3.2.1" />
+    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="5.0.0" />
+    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="5.0.0">
+    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="5.0.0" />
+    <PackageReference Include="System.Net.Http.Json" Version="5.0.0" />
</ItemGroup>
```

## <a name="update-docker-images"></a><span data-ttu-id="108de-192">Aktualisieren von Docker-Images</span><span class="sxs-lookup"><span data-stu-id="108de-192">Update Docker images</span></span>

<span data-ttu-id="108de-193">Aktualisieren Sie die *dockerfile* `FROM` -Anweisungen und-Skripts für apps, die Docker verwenden.</span><span class="sxs-lookup"><span data-stu-id="108de-193">For apps using Docker, update your *Dockerfile* `FROM` statements and scripts.</span></span> <span data-ttu-id="108de-194">Verwenden Sie ein Basis Image, das den ASP.net Core 5,0-Lauf Zeit Modul einschließt.</span><span class="sxs-lookup"><span data-stu-id="108de-194">Use a base image that includes the ASP.NET Core 5.0 runtime.</span></span> <span data-ttu-id="108de-195">Beachten Sie den folgenden `docker pull` Befehls Unterschied zwischen ASP.net Core 3,1 und 5,0:</span><span class="sxs-lookup"><span data-stu-id="108de-195">Consider the following `docker pull` command difference between ASP.NET Core 3.1 and 5.0:</span></span>

```diff
- docker pull mcr.microsoft.com/dotnet/core/aspnet:3.1
+ docker pull mcr.microsoft.com/dotnet/aspnet:5.0
```

<span data-ttu-id="108de-196">Im Rahmen der Umstellung auf ".net" als Produktname wurden die Docker-Images aus den `mcr.microsoft.com/dotnet/core` Depots in verschoben `mcr.microsoft.com/dotnet` .</span><span class="sxs-lookup"><span data-stu-id="108de-196">As part of the move to ".NET" as the product name, the Docker images moved from the `mcr.microsoft.com/dotnet/core` repositories to `mcr.microsoft.com/dotnet`.</span></span> <span data-ttu-id="108de-197">Weitere Informationen finden Sie unter [dotnet/dotnet-docker # 1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span><span class="sxs-lookup"><span data-stu-id="108de-197">For more information, see [dotnet/dotnet-docker#1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span></span>

## <a name="model-binding-changes-in-aspnet-core-mvc-and-no-locrazor-pages"></a><span data-ttu-id="108de-198">Änderungen an der Modell Bindung in ASP.net Core MVC und Razor Seiten</span><span class="sxs-lookup"><span data-stu-id="108de-198">Model binding changes in ASP.NET Core MVC and Razor Pages</span></span>

### <a name="datetime-values-are-model-bound-as-utc-times"></a><span data-ttu-id="108de-199">DateTime-Werte sind als UTC-Zeitmodell gebunden.</span><span class="sxs-lookup"><span data-stu-id="108de-199">DateTime values are model bound as UTC times</span></span>

<span data-ttu-id="108de-200">In ASP.net Core 3,1 und früheren Versionen `DateTime` Warenwerte Modell gebunden als lokale Zeit, in der die Zeitzone vom Server bestimmt wurde.</span><span class="sxs-lookup"><span data-stu-id="108de-200">In ASP.NET Core 3.1 and earlier, `DateTime` values were model-bound as local time, where the timezone was determined by the server.</span></span> <span data-ttu-id="108de-201">`DateTime` Werte, die von der Eingabe Formatierung (JSON) und den Werten gebunden sind, `DateTimeOffset` wurden als UTC-Zeit Zonen gebunden.</span><span class="sxs-lookup"><span data-stu-id="108de-201">`DateTime` values bound from input formatting (JSON) and `DateTimeOffset` values were bound as UTC timezones.</span></span>

<span data-ttu-id="108de-202">In ASP.net Core 5,0 und höher bindet die Modell Bindung `DateTime` die Werte konsistent an die UTC-Zeitzone.</span><span class="sxs-lookup"><span data-stu-id="108de-202">In ASP.NET Core 5.0 and later, model binding consistently binds `DateTime` values with the UTC timezone.</span></span>

<span data-ttu-id="108de-203">Wenn Sie das vorherige Verhalten beibehalten möchten, entfernen Sie das `DateTimeModelBinderProvider` in `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="108de-203">To retain the previous behavior, remove the `DateTimeModelBinderProvider` in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddControllersWithViews(options => 
    options.ModelBinderProviders.RemoveType<DateTimeModelBinderProvider>());
```

### <a name="complexobjectmodelbinderprovider--complexobjectmodelbinder-replace-complextypemodelbinderprovider--complextypemodelbinder"></a><span data-ttu-id="108de-204">Complexobjectmodelbinderprovider \ complexobjectmodelbinder Replace complextypemodelbinderprovider \ complextypemodelbinder</span><span class="sxs-lookup"><span data-stu-id="108de-204">ComplexObjectModelBinderProvider \ ComplexObjectModelBinder replace ComplexTypeModelBinderProvider \ ComplexTypeModelBinder</span></span>

<span data-ttu-id="108de-205">Zum Hinzufügen der Unterstützung für Modell Bindung [c# 9-Daten Satz Typen](/dotnet/csharp/whats-new/csharp-9#record-types) <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> ist:</span><span class="sxs-lookup"><span data-stu-id="108de-205">To add support for model binding [C# 9 record types](/dotnet/csharp/whats-new/csharp-9#record-types), the <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> is:</span></span>

* <span data-ttu-id="108de-206">Als veraltet gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="108de-206">Annotated as obsolete.</span></span>
* <span data-ttu-id="108de-207">Nicht mehr standardmäßig registriert.</span><span class="sxs-lookup"><span data-stu-id="108de-207">No longer registered by default.</span></span>

<span data-ttu-id="108de-208">Apps, die auf dem vorhanden sein von in der-Auflistung basieren, `ComplexTypeModelBinderProvider` `ModelBinderProviders` müssen auf den neuen Binder Anbieter verweisen:</span><span class="sxs-lookup"><span data-stu-id="108de-208">Apps that rely on the presence of the `ComplexTypeModelBinderProvider` in the `ModelBinderProviders` collection need to reference the new binder provider:</span></span>

```diff
- var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexTypeModelBinderProvider>();
+ var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexObjectModelBinderProvider>();
```

## <a name="review-breaking-changes"></a><span data-ttu-id="108de-209">Wichtige Änderungen überprüfen</span><span class="sxs-lookup"><span data-stu-id="108de-209">Review breaking changes</span></span>

<span data-ttu-id="108de-210">Grundlegende Änderungen von .net Core 3,1 auf .net 5,0 finden Sie unter [Breaking Changes for Migration from Version 3,1 to 5,0](/dotnet/core/compatibility/3.1-5.0).</span><span class="sxs-lookup"><span data-stu-id="108de-210">For breaking changes from .NET Core 3.1 to .NET 5.0, see [Breaking changes for migration from version 3.1 to 5.0](/dotnet/core/compatibility/3.1-5.0).</span></span> <span data-ttu-id="108de-211">ASP.net Core und Entity Framework Core sind auch in der Liste enthalten.</span><span class="sxs-lookup"><span data-stu-id="108de-211">ASP.NET Core and Entity Framework Core are also included in the list.</span></span>
